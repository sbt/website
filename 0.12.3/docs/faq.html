


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Frequently Asked Questions &mdash; sbt Documentation</title>
    
    <link rel="stylesheet" href="_static/style.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/issuetracker.css" type="text/css" />
    <link rel="stylesheet" href="_static/base.css" type="text/css" />
    <link rel="stylesheet" href="_static/docs.css" type="text/css" />
    <link rel="stylesheet" href="_static/syntax.css" type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Exo:300,400,600,700" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.12.3-RC1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="../../versions.js"></script>
    <script type="text/javascript" src="_static/set-versions.js"></script>
    <link rel="top" title="sbt Documentation" href="index.html" />
    <link rel="up" title="Contents" href="index.html" />
    <link rel="next" title="Community" href="Community/index.html" />
    <link rel="prev" title="Triggered execution" href="Howto/triggered.html" /> 
  </head>
  <body>
  <div class="navbar">
    <div class="navbar-inner">
      <div class="container">
        <ul class="nav">
          <li><a href="http://www.scala-sbt.org/">Home</a></li>
          <li><a href="index.html">Documentation</a></li>
          <li><a href="Getting-Started/Setup.html">Download</a></li>
          <li><a href="http://groups.google.com/group/simple-build-tool">Mailing List</a></li>
          <li><a href="http://github.com/sbt/sbt">Project</a></li>           
        </ul>
      </div>
    </div>
  </div>
  <div class="main">
    <div class="container">
      <div class="page-title">Frequently Asked Questions</div>
      <div class="search-box">
        <form method="get" action="http://www.google.com/search" id="search">
          <input type="search" placeholder="Search 0.12.3-RC1 on Google" name="q" results="10" size="29" id="search-input">
          <input type="hidden"  name="sitesearch" value="http://www.scala-sbt.org/release/docs/"> 
          <input type="submit" id="submit-search">
        </form>
      </div>
    </div>
    <div class="main-container">
      <div class="container">
        <div class="row">
          <div class="span12">
            <ul class="breadcrumb">        
              <li>
                 <span class="divider">|</span> <a href="Community/index.html">Community</a> <span class="divider">»</span>
              </li>
              <li>
              </li>
              <li>
                <a href="index.html">Contents</a>
              </li>
              <li>
                <span class="divider">«</span> <a href="Howto/triggered.html">Triggered execution</a> <span class="divider">|</span>
              </li>
              <li>
                <select id="versions"><option selected value="0.12.3-RC1">Version 0.12.3-RC1</option></select>
              </li>
            </ul>         
          </div>
        </div>
        <div class="row">
          <div class="span9">
            
  <div class="section" id="frequently-asked-questions">
<h1>Frequently Asked Questions<a class="headerlink" href="#frequently-asked-questions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="project-information">
<h2>Project Information<a class="headerlink" href="#project-information" title="Permalink to this headline">¶</a></h2>
<div class="section" id="how-do-i-get-help">
<h3>How do I get help?<a class="headerlink" href="#how-do-i-get-help" title="Permalink to this headline">¶</a></h3>
<p>Please use the <a class="reference external" href="http://groups.google.com/group/simple-build-tool/topics">mailing list</a> for questions, comments, and discussions.</p>
<ul class="simple">
<li>Please state the problem or question clearly and provide enough
context. Code examples and build transcripts are often useful when
appropriately edited.</li>
<li>Providing small, reproducible examples are a good way to get help
quickly.</li>
<li>Include relevant information such as the version of sbt and Scala
being used.</li>
</ul>
</div>
<div class="section" id="how-do-i-report-a-bug">
<h3>How do I report a bug?<a class="headerlink" href="#how-do-i-report-a-bug" title="Permalink to this headline">¶</a></h3>
<p>Please use the <a class="reference external" href="https://github.com/sbt/sbt/issues">issue tracker</a>
to report confirmed bugs. Do not use it to ask questions. If you are
uncertain whether something is a bug, please ask on the <a class="reference external" href="http://groups.google.com/group/simple-build-tool/topics">mailing list</a> first.</p>
</div>
<div class="section" id="how-can-i-help">
<h3>How can I help?<a class="headerlink" href="#how-can-i-help" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Fix mistakes that you notice on the wiki.</li>
<li>Make <a class="reference external" href="https://github.com/sbt/sbt/issues">bug reports</a> that are
clear and reproducible.</li>
<li>Answer questions on the <a class="reference external" href="http://groups.google.com/group/simple-build-tool/topics">mailing list</a>.</li>
<li>Fix issues that affect you. <a class="reference external" href="http://help.github.com/fork-a-repo/">Fork, fix, and submit a pull
request</a>.</li>
<li>Implement features that are important to you. There is an
<a class="reference internal" href="Community/Opportunities.html"><em>Opportunites</em></a> page for some ideas, but the most useful
contributions are usually ones you want yourself.</li>
</ul>
<p>For more details on developing sbt, see
<a class="reference external" href="http://harrah.github.com/xsbt/Developing.pdf">Developing.pdf</a></p>
</div>
</div>
<div class="section" id="to-0-10-migration">
<h2>0.7 to 0.10+ Migration<a class="headerlink" href="#to-0-10-migration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="how-do-i-migrate-from-0-7-to-0-10">
<h3>How do I migrate from 0.7 to 0.10+?<a class="headerlink" href="#how-do-i-migrate-from-0-7-to-0-10" title="Permalink to this headline">¶</a></h3>
<p>See the <a class="reference internal" href="Detailed-Topics/Migrating-from-sbt-0.7.x-to-0.10.x.html"><em>migration page</em></a> first and
then the following questions.</p>
</div>
<div class="section" id="where-has-0-7-s-lib-managed-gone">
<h3>Where has 0.7's <tt class="docutils literal"><span class="pre">lib_managed</span></tt> gone?<a class="headerlink" href="#where-has-0-7-s-lib-managed-gone" title="Permalink to this headline">¶</a></h3>
<p>By default, sbt 0.12 loads managed libraries from your ivy cache without
copying them to a <tt class="docutils literal"><span class="pre">lib_managed</span></tt> directory. This fixes some bugs with
the previous solution and keeps your project directory small. If you
want to insulate your builds from the ivy cache being cleared, set
<tt class="docutils literal"><span class="pre">retrieveManaged</span> <span class="pre">:=</span> <span class="pre">true</span></tt> and the dependencies will be copied to
<tt class="docutils literal"><span class="pre">lib_managed</span></tt> as a build-local cache (while avoiding the issues of
<tt class="docutils literal"><span class="pre">lib_managed</span></tt> in 0.7.x).</p>
<p>This does mean that existing solutions for sharing libraries with your
favoured IDE may not work. There are 0.12 plugins for IDEs being
developed:</p>
<ul class="simple">
<li>IntelliJ IDEA: [[<a class="reference external" href="https://github.com/mpeltonen/sbt-idea">https://github.com/mpeltonen/sbt-idea</a>]]</li>
<li>Netbeans: [[<a class="reference external" href="https://github.com/remeniuk/sbt-netbeans-plugin">https://github.com/remeniuk/sbt-netbeans-plugin</a>]]</li>
<li>Eclipse: [[<a class="reference external" href="https://github.com/typesafehub/sbteclipse">https://github.com/typesafehub/sbteclipse</a>]]</li>
</ul>
</div>
<div class="section" id="what-are-the-commands-i-can-use-in-version-vs-0-7">
<h3>What are the commands I can use in 0.12 vs. 0.7?<a class="headerlink" href="#what-are-the-commands-i-can-use-in-version-vs-0-7" title="Permalink to this headline">¶</a></h3>
<p>For a list of commands, run <tt class="docutils literal"><span class="pre">help</span></tt>. For details on a specific command,
run <tt class="docutils literal"><span class="pre">help</span> <span class="pre">&lt;command&gt;</span></tt>. To view a list of tasks defined on the current
project, run <tt class="docutils literal"><span class="pre">tasks</span></tt>. Alternatively, see the <a class="reference internal" href="Getting-Started/Running.html"><em>Running</em></a>
page in the Getting Started Guide for descriptions of common commands and tasks.</p>
<p>If in doubt start by just trying the old command as it may just work.
The built in TAB completion will also assist you, so you can just press
TAB at the beginning of a line and see what you get.</p>
<p>The following commands work pretty much as in 0.7 out of the box:</p>
<div class="highlight-text"><div class="highlight"><pre>reload
update
compile
test
test-only
publish-local
exit
</pre></div>
</div>
</div>
<div class="section" id="why-have-the-resolved-dependencies-in-a-multi-module-project-changed-since-0-7">
<h3>Why have the resolved dependencies in a multi-module project changed since 0.7?<a class="headerlink" href="#why-have-the-resolved-dependencies-in-a-multi-module-project-changed-since-0-7" title="Permalink to this headline">¶</a></h3>
<p>sbt 0.10 fixes a flaw in how dependencies get resolved in multi-module
projects. This change ensures that only one version of a library appears
on a classpath.</p>
<p>Use <tt class="docutils literal"><span class="pre">last</span> <span class="pre">update</span></tt> to view the debugging output for the last <tt class="docutils literal"><span class="pre">update</span></tt>
run. Use <tt class="docutils literal"><span class="pre">show</span> <span class="pre">update</span></tt> to view a summary of files comprising managed
classpaths.</p>
</div>
<div class="section" id="my-tests-all-run-really-fast-but-some-are-broken-that-weren-t-in-0-7">
<h3>My tests all run really fast but some are broken that weren't in 0.7!<a class="headerlink" href="#my-tests-all-run-really-fast-but-some-are-broken-that-weren-t-in-0-7" title="Permalink to this headline">¶</a></h3>
<p>Be aware that compilation and tests run in parallel by default in sbt
0.12. If your test code isn't thread-safe then you may want to change
this behaviour by adding one of the following to your <tt class="docutils literal"><span class="pre">build.sbt</span></tt>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// Execute tests in the current project serially.</span>
<span class="c1">// Tests from other projects may still run concurrently.</span>
<span class="n">parallelExecution</span> <span class="n">in</span> <span class="nc">Test</span> <span class="o">:=</span> <span class="kc">false</span>

<span class="c1">// Execute everything serially (including compilation and tests)</span>
<span class="n">parallelExecution</span> <span class="o">:=</span> <span class="kc">false</span>
</pre></div>
</div>
</div>
<div class="section" id="how-do-i-set-log-levels-in-version-vs-0-7">
<h3>How do I set log levels in 0.12 vs. 0.7?<a class="headerlink" href="#how-do-i-set-log-levels-in-version-vs-0-7" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">warn</span></tt>, <tt class="docutils literal"><span class="pre">info</span></tt>, <tt class="docutils literal"><span class="pre">debug</span></tt> and <tt class="docutils literal"><span class="pre">error</span></tt> don't work any more.</p>
<p>The new syntax in the sbt 0.12 shell is:
<tt class="docutils literal"><span class="pre">text</span> <span class="pre">&gt;</span> <span class="pre">set</span> <span class="pre">logLevel</span> <span class="pre">:=</span> <span class="pre">Level.Warn</span></tt></p>
<p>Or in your <tt class="docutils literal"><span class="pre">build.sbt</span></tt> file write:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">logLevel</span> <span class="o">:=</span> <span class="nc">Level</span><span class="o">.</span><span class="nc">Warn</span>
</pre></div>
</div>
</div>
<div class="section" id="what-happened-to-the-web-development-and-web-start-support-since-0-7">
<h3>What happened to the web development and Web Start support since 0.7?<a class="headerlink" href="#what-happened-to-the-web-development-and-web-start-support-since-0-7" title="Permalink to this headline">¶</a></h3>
<p>Web application support was split out into a plugin. See the
<a class="reference external" href="https://github.com/JamesEarlDouglas/xsbt-web-plugin">xsbt-web-plugin</a> project.</p>
<p>For an early version of an xsbt Web Start plugin, visit the
<a class="reference external" href="https://github.com/ritschwumm/xsbt-webstart">xsbt-webstart</a> project.</p>
</div>
<div class="section" id="how-are-inter-project-dependencies-different-in-version-vs-0-7">
<h3>How are inter-project dependencies different in 0.12 vs. 0.7?<a class="headerlink" href="#how-are-inter-project-dependencies-different-in-version-vs-0-7" title="Permalink to this headline">¶</a></h3>
<p>In 0.12, there are three types of project dependencies (classpath,
execution, and configuration) and they are independently defined. These
were combined in a single dependency type in 0.7.x. A declaration like:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">lazy</span> <span class="k">val</span> <span class="n">a</span> <span class="k">=</span> <span class="n">project</span><span class="o">(</span><span class="s">&quot;a&quot;</span><span class="o">,</span> <span class="s">&quot;A&quot;</span><span class="o">)</span>
<span class="k">lazy</span> <span class="k">val</span> <span class="n">b</span> <span class="k">=</span> <span class="n">project</span><span class="o">(</span><span class="s">&quot;b&quot;</span><span class="o">,</span> <span class="s">&quot;B&quot;</span><span class="o">,</span> <span class="n">a</span><span class="o">)</span>
</pre></div>
</div>
<p>meant that the <tt class="docutils literal"><span class="pre">B</span></tt> project had a classpath and execution dependency on
<tt class="docutils literal"><span class="pre">A</span></tt> and <tt class="docutils literal"><span class="pre">A</span></tt> had a configuration dependency on <tt class="docutils literal"><span class="pre">B</span></tt>. Specifically,
in 0.7.x:</p>
<ol class="arabic simple">
<li>Classpath: Classpaths for <tt class="docutils literal"><span class="pre">A</span></tt> were available on the appropriate
classpath for <tt class="docutils literal"><span class="pre">B</span></tt>.</li>
<li>Execution: A task executed on <tt class="docutils literal"><span class="pre">B</span></tt> would be executed on <tt class="docutils literal"><span class="pre">A</span></tt> first.</li>
<li>Configuration: For some settings, if they were not overridden in
<tt class="docutils literal"><span class="pre">A</span></tt>, they would default to the value provided in <tt class="docutils literal"><span class="pre">B</span></tt>.</li>
</ol>
<p>In 0.12, declare the specific type of dependency you want. Read about
<a class="reference internal" href="Getting-Started/Multi-Project.html"><em>multi-project builds</em></a> in the Getting
Started Guide for details.</p>
</div>
<div class="section" id="where-did-class-object-x-go-since-0-7">
<h3>Where did class/object X go since 0.7?<a class="headerlink" href="#where-did-class-object-x-go-since-0-7" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">0.7</th>
<th class="head">0.12</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><a class="reference external" href="http://simple-build-tool.googlecode.com/svn/artifacts/latest/api/sbt/FileUtilities$object.html">FileUtilities</a></div>
</div>
</td>
<td><a class="reference external" href="../api/sbt/IO$.html">IO</a></td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://simple-build-tool.googlecode.com/svn/artifacts/latest/api/sbt/Path.html">Path class</a> and <a class="reference external" href="http://simple-build-tool.googlecode.com/svn/artifacts/latest/api/sbt/Path$.html">object</a></td>
<td><a class="reference external" href="../api/sbt/Path$.html">Path object</a>, <tt class="docutils literal"><span class="pre">File</span></tt>, <a class="reference external" href="../api/sbt/RichFile.html">RichFile</a></td>
</tr>
<tr class="row-even"><td><a class="reference external" href="http://simple-build-tool.googlecode.com/svn/artifacts/latest/api/sbt/PathFinder.html">PathFinder class</a></td>
<td><tt class="docutils literal"><span class="pre">Seq[File]</span></tt>, <a class="reference external" href="../api/sbt/PathFinder.html">PathFinder class</a>, <a class="reference external" href="../api/sbt/PathFinder$.html">PathFinder object</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="where-can-i-find-plugins-for-version">
<h3>Where can I find plugins for 0.12?<a class="headerlink" href="#where-can-i-find-plugins-for-version" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="Community/Community-Plugins.html"><em>Community Plugins</em></a> for a list of currently available plugins.</p>
</div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="my-last-command-didn-t-work-but-i-can-t-see-an-explanation-why">
<h3>My last command didn't work but I can't see an explanation. Why?<a class="headerlink" href="#my-last-command-didn-t-work-but-i-can-t-see-an-explanation-why" title="Permalink to this headline">¶</a></h3>
<p>sbt 0.12 by default suppresses most stack traces and debugging
information. It has the nice side effect of giving you less noise on
screen, but as a newcomer it can leave you lost for explanation. To see
the previous output of a command at a higher verbosity, type
<tt class="docutils literal"><span class="pre">last</span> <span class="pre">&lt;task&gt;</span></tt> where <tt class="docutils literal"><span class="pre">&lt;task&gt;</span></tt> is the task that failed or that you
want to view detailed output for. For example, if you find that your
<tt class="docutils literal"><span class="pre">update</span></tt> fails to load all the dependencies as you expect you can
enter:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">&gt;</span> last update
</pre></div>
</div>
<p>and it will display the full output from the last run of the <tt class="docutils literal"><span class="pre">update</span></tt>
command.</p>
</div>
<div class="section" id="how-do-i-disable-ansi-codes-in-the-output">
<h3>How do I disable ansi codes in the output?<a class="headerlink" href="#how-do-i-disable-ansi-codes-in-the-output" title="Permalink to this headline">¶</a></h3>
<p>Sometimes sbt doesn't detect that ansi codes aren't supported and you
get output that looks like:</p>
<div class="highlight-text"><div class="highlight"><pre>[0m[ [0minfo [0m]  [0mSet current project to root
</pre></div>
</div>
<p>or ansi codes are supported but you want to disable colored output. To
completely disable ansi codes, set the <tt class="docutils literal"><span class="pre">sbt.log.noformat</span></tt> system
property to <tt class="docutils literal"><span class="pre">true</span></tt>. For example,</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> sbt -Dsbt.log.noformat<span class="o">=</span><span class="nb">true</span>
</pre></div>
</div>
</div>
<div class="section" id="how-can-i-start-a-scala-interpreter-repl-with-sbt-project-configuration-dependencies-etc">
<h3>How can I start a Scala interpreter (REPL) with sbt project configuration (dependencies, etc.)?<a class="headerlink" href="#how-can-i-start-a-scala-interpreter-repl-with-sbt-project-configuration-dependencies-etc" title="Permalink to this headline">¶</a></h3>
<p>You may run <tt class="docutils literal"><span class="pre">sbt</span> <span class="pre">console</span></tt>.</p>
</div>
</div>
<div class="section" id="build-definitions">
<h2>Build definitions<a class="headerlink" href="#build-definitions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-are-the-and-methods">
<h3>What are the <tt class="docutils literal"><span class="pre">:=</span></tt>, <tt class="docutils literal"><span class="pre">~=</span></tt>, <tt class="docutils literal"><span class="pre">&lt;&lt;=</span></tt>, <tt class="docutils literal"><span class="pre">+=</span></tt>, <tt class="docutils literal"><span class="pre">++=</span></tt>, <tt class="docutils literal"><span class="pre">&lt;+=</span></tt>, and <tt class="docutils literal"><span class="pre">&lt;++=</span></tt> methods?<a class="headerlink" href="#what-are-the-and-methods" title="Permalink to this headline">¶</a></h3>
<p>These are methods on keys used to construct a <tt class="docutils literal"><span class="pre">Setting</span></tt>. The Getting
Started Guide covers all these methods, see <a class="reference internal" href="Getting-Started/Basic-Def.html"><em>.sbt build definition</em></a>
and <a class="reference internal" href="Getting-Started/More-About-Settings.html"><em>more about settings</em></a> for example.</p>
</div>
<div class="section" id="what-is-the-method">
<h3>What is the <tt class="docutils literal"><span class="pre">%</span></tt> method?<a class="headerlink" href="#what-is-the-method" title="Permalink to this headline">¶</a></h3>
<p>It's used to create a <tt class="docutils literal"><span class="pre">ModuleID</span></tt> from strings, when specifying managed
dependencies. Read the Getting Started Guide about
<a class="reference internal" href="Getting-Started/Library-Dependencies.html"><em>library dependencies</em></a>.</p>
</div>
<div class="section" id="what-is-moduleid-project">
<h3>What is <tt class="docutils literal"><span class="pre">ModuleID</span></tt>, <tt class="docutils literal"><span class="pre">Project</span></tt>, ...?<a class="headerlink" href="#what-is-moduleid-project" title="Permalink to this headline">¶</a></h3>
<p>To figure out an unknown type or method, have a look at the
<a class="reference internal" href="Getting-Started/Welcome.html"><em>Getting Started Guide</em></a> if you have not.
Also try the <a class="reference internal" href="Name-Index.html"><em>index</em></a> of commonly used methods, values, and types,
the <a class="reference external" href="../api/index">API Documentation</a> and the
<a class="reference external" href="../sxr/index">hyperlinked sources</a>.</p>
</div>
<div class="section" id="how-can-one-key-depend-on-multiple-other-keys">
<h3>How can one key depend on multiple other keys?<a class="headerlink" href="#how-can-one-key-depend-on-multiple-other-keys" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="Getting-Started/More-About-Settings.html"><em>More About Settings</em></a> in the
Getting Started Guide, scroll down to the discussion of <tt class="docutils literal"><span class="pre">&lt;&lt;=</span></tt> with
multiple keys.</p>
<p>Briefly: You need to use a tuple rather than a single key by itself.
Scala's syntax for a tuple is with parentheses, like <tt class="docutils literal"><span class="pre">(a,</span> <span class="pre">b,</span> <span class="pre">c)</span></tt>.</p>
<p>If you're creating a value for a task key, then you'll use <tt class="docutils literal"><span class="pre">map</span></tt>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">packageBin</span> <span class="n">in</span> <span class="nc">Compile</span> <span class="o">&lt;&lt;=</span> <span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">organization</span><span class="o">,</span> <span class="n">version</span><span class="o">)</span> <span class="n">map</span> <span class="o">{</span> <span class="o">(</span><span class="n">n</span><span class="o">,</span> <span class="n">o</span><span class="o">,</span> <span class="n">v</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">file</span><span class="o">(</span><span class="n">o</span> <span class="o">+</span> <span class="s">&quot;-&quot;</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="s">&quot;-&quot;</span> <span class="o">+</span> <span class="n">v</span> <span class="o">+</span> <span class="s">&quot;.jar&quot;</span><span class="o">)</span> <span class="o">}</span>
</pre></div>
</div>
<p>If you're creating a value for a setting key, then you'll use <tt class="docutils literal"><span class="pre">apply</span></tt>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">name</span> <span class="o">&lt;&lt;=</span> <span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">organization</span><span class="o">,</span> <span class="n">version</span><span class="o">)</span> <span class="n">apply</span> <span class="o">{</span> <span class="o">(</span><span class="n">n</span><span class="o">,</span> <span class="n">o</span><span class="o">,</span> <span class="n">v</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="s">&quot;project &quot;</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="s">&quot; from &quot;</span> <span class="o">+</span> <span class="n">o</span> <span class="o">+</span> <span class="s">&quot; version &quot;</span> <span class="o">+</span> <span class="n">v</span> <span class="o">}</span>
</pre></div>
</div>
<p>Typing <tt class="docutils literal"><span class="pre">apply</span></tt> is optional in that code, since Scala treats any object
with an <tt class="docutils literal"><span class="pre">apply</span></tt> method as a function. See <a class="reference internal" href="Getting-Started/More-About-Settings.html"><em>More About Settings</em></a>
for a longer explanation.</p>
<p>To learn about task keys vs. setting keys, read <a class="reference internal" href="Getting-Started/Basic-Def.html"><em>.sbt build definition</em></a>.</p>
</div>
<div class="section" id="how-do-i-add-files-to-a-jar-package">
<h3>How do I add files to a jar package?<a class="headerlink" href="#how-do-i-add-files-to-a-jar-package" title="Permalink to this headline">¶</a></h3>
<p>The files included in an artifact are configured by default by a task
<tt class="docutils literal"><span class="pre">mappings</span></tt> that is scoped by the relevant package task. The
<tt class="docutils literal"><span class="pre">mappings</span></tt> task returns a sequence <tt class="docutils literal"><span class="pre">Seq[(File,String)]</span></tt> of mappings
from the file to include to the path within the jar. See
<a class="reference internal" href="Detailed-Topics/Mapping-Files.html"><em>Mapping Files</em></a> for details on creating these mappings.</p>
<p>For example, to add generated sources to the packaged source artifact:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">mappings</span> <span class="n">in</span> <span class="o">(</span><span class="nc">Compile</span><span class="o">,</span> <span class="n">packageSrc</span><span class="o">)</span> <span class="o">&lt;++=</span>
  <span class="o">(</span><span class="n">sourceManaged</span> <span class="n">in</span> <span class="nc">Compile</span><span class="o">,</span> <span class="n">managedSources</span> <span class="n">in</span> <span class="nc">Compile</span><span class="o">)</span> <span class="n">map</span> <span class="o">{</span> <span class="o">(</span><span class="n">base</span><span class="o">,</span> <span class="n">srcs</span><span class="o">)</span> <span class="k">=&gt;</span>
      <span class="k">import</span> <span class="nn">Path.</span><span class="o">{</span><span class="n">flat</span><span class="o">,</span> <span class="n">relativeTo</span><span class="o">}</span>
    <span class="n">srcs</span> <span class="n">x</span> <span class="o">(</span><span class="n">relativeTo</span><span class="o">(</span><span class="n">base</span><span class="o">)</span> <span class="o">|</span> <span class="n">flat</span><span class="o">)</span>
  <span class="o">}</span>
</pre></div>
</div>
<p>This takes sources from the <tt class="docutils literal"><span class="pre">managedSources</span></tt> task and relativizes them
against the <tt class="docutils literal"><span class="pre">managedSource</span></tt> base directory, falling back to a
flattened mapping. If a source generation task doesn't write the sources
to the <tt class="docutils literal"><span class="pre">managedSource</span></tt> directory, the mapping function would have to
be adjusted to try relativizing against additional directories or
something more appropriate for the generator.</p>
</div>
<div class="section" id="how-can-i-generate-source-code-or-resources">
<span id="generate-sources-resources"></span><h3>How can I generate source code or resources?<a class="headerlink" href="#how-can-i-generate-source-code-or-resources" title="Permalink to this headline">¶</a></h3>
<p>sbt provides standard hooks for adding source or resource generation
tasks. A generation task should generate sources in a subdirectory of
<tt class="docutils literal"><span class="pre">sourceManaged</span></tt> for sources or <tt class="docutils literal"><span class="pre">resourceManaged</span></tt> for resources and
return a sequence of files generated. The key to add the task to is
called <tt class="docutils literal"><span class="pre">sourceGenerators</span></tt> for sources and <tt class="docutils literal"><span class="pre">resourceGenerators</span></tt> for
resources. It should be scoped according to whether the generated files
are main (<tt class="docutils literal"><span class="pre">Compile</span></tt>) or test (<tt class="docutils literal"><span class="pre">Test</span></tt>) sources or resources. This
basic structure looks like:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">sourceGenerators</span> <span class="n">in</span> <span class="nc">Compile</span> <span class="o">&lt;+=</span> <span class="o">&lt;</span><span class="n">your</span> <span class="nc">Task</span><span class="o">[</span><span class="kt">Seq</span><span class="o">[</span><span class="kt">File</span><span class="o">]]</span> <span class="n">here</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>For example, assuming a method
<tt class="docutils literal"><span class="pre">def</span> <span class="pre">makeSomeSources(base:</span> <span class="pre">File):</span> <span class="pre">Seq[File]</span></tt>,</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">sourceGenerators</span> <span class="n">in</span> <span class="nc">Compile</span> <span class="o">&lt;+=</span> <span class="n">sourceManaged</span> <span class="n">in</span> <span class="nc">Compile</span> <span class="n">map</span> <span class="o">{</span> <span class="n">outDir</span><span class="k">:</span> <span class="kt">File</span> <span class="o">=&gt;</span>
  <span class="n">makeSomeSources</span><span class="o">(</span><span class="n">outDir</span> <span class="o">/</span> <span class="s">&quot;demo&quot;</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>As a specific example, the following generates a hello world source
file:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">sourceGenerators</span> <span class="n">in</span> <span class="nc">Compile</span> <span class="o">&lt;+=</span> <span class="n">sourceManaged</span> <span class="n">in</span> <span class="nc">Compile</span> <span class="n">map</span> <span class="o">{</span> <span class="n">dir</span> <span class="k">=&gt;</span>
  <span class="k">val</span> <span class="n">file</span> <span class="k">=</span> <span class="n">dir</span> <span class="o">/</span> <span class="s">&quot;demo&quot;</span> <span class="o">/</span> <span class="s">&quot;Test.scala&quot;</span>
  <span class="nc">IO</span><span class="o">.</span><span class="n">write</span><span class="o">(</span><span class="n">file</span><span class="o">,</span> <span class="s">&quot;&quot;&quot;object Test extends App { println(&quot;Hi&quot;) }&quot;&quot;&quot;</span><span class="o">)</span>
  <span class="nc">Seq</span><span class="o">(</span><span class="n">file</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Executing 'run' will print &quot;Hi&quot;. Change <tt class="docutils literal"><span class="pre">Compile</span></tt> to <tt class="docutils literal"><span class="pre">Test</span></tt> to make
it a test source. To generate resources, change <tt class="docutils literal"><span class="pre">sourceGenerators</span></tt> to
<tt class="docutils literal"><span class="pre">resourceGenerators</span></tt> and <tt class="docutils literal"><span class="pre">sourceManaged</span></tt> to <tt class="docutils literal"><span class="pre">resourceManaged</span></tt>.
Normally, you would only want to generate sources when necessary and not
every run.</p>
<p>By default, generated sources and resources are not included in the
packaged source artifact. To do so, add them as you would other
mappings. See the <tt class="docutils literal"><span class="pre">Adding</span> <span class="pre">files</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">package</span></tt> section.</p>
</div>
<div class="section" id="how-can-a-task-avoid-redoing-work-if-the-input-files-are-unchanged">
<h3>How can a task avoid redoing work if the input files are unchanged?<a class="headerlink" href="#how-can-a-task-avoid-redoing-work-if-the-input-files-are-unchanged" title="Permalink to this headline">¶</a></h3>
<p>There is basic support for only doing work when input files have changed
or when the outputs haven't been generated yet. This support is
primitive and subject to change.</p>
<p>The relevant methods are two overloaded methods called
<a class="reference external" href="../api/sbt/FileFunction$.html">FileFunction.cached</a>.
Each requires a directory in which to store cached data. Sample usage
is:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// define a task that takes some inputs</span>
<span class="c1">//   and generates files in an output directory</span>
<span class="n">myTask</span> <span class="o">&lt;&lt;=</span> <span class="o">(</span><span class="n">cacheDirectory</span><span class="o">,</span> <span class="n">inputs</span><span class="o">,</span> <span class="n">target</span><span class="o">)</span> <span class="n">map</span> <span class="o">{</span>
  <span class="o">(</span><span class="n">cache</span><span class="k">:</span> <span class="kt">File</span><span class="o">,</span> <span class="n">inFiles</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">File</span><span class="o">],</span> <span class="n">outDir</span><span class="k">:</span> <span class="kt">File</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// wraps a function taskImpl in an uptodate check</span>
    <span class="c1">//   taskImpl takes the input files, the output directory,</span>
    <span class="c1">//   generates the output files and returns the set of generated files</span>
    <span class="k">val</span> <span class="n">cachedFun</span> <span class="k">=</span> <span class="nc">FileFunction</span><span class="o">.</span><span class="n">cached</span><span class="o">(</span><span class="n">cache</span> <span class="o">/</span> <span class="s">&quot;my-task&quot;</span><span class="o">)</span> <span class="o">{</span> <span class="o">(</span><span class="n">in</span><span class="k">:</span> <span class="kt">Set</span><span class="o">[</span><span class="kt">File</span><span class="o">])</span> <span class="k">=&gt;</span>
      <span class="n">taskImpl</span><span class="o">(</span><span class="n">in</span><span class="o">,</span> <span class="n">outDir</span><span class="o">)</span> <span class="k">:</span> <span class="kt">Set</span><span class="o">[</span><span class="kt">File</span><span class="o">]</span>
    <span class="o">}</span>
    <span class="c1">// Applies the cached function to the inputs files</span>
    <span class="n">cachedFun</span><span class="o">(</span><span class="n">inFiles</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>There are two additional arguments for the first parameter list that
allow the file tracking style to be explicitly specified. By default,
the input tracking style is <tt class="docutils literal"><span class="pre">FilesInfo.lastModified</span></tt>, based on a
file's last modified time, and the output tracking style is
<tt class="docutils literal"><span class="pre">FilesInfo.exists</span></tt>, based only on whether the file exists. The other
available style is <tt class="docutils literal"><span class="pre">FilesInfo.hash</span></tt>, which tracks a file based on a
hash of its contents. See the <a class="reference external" href="../api/sbt/FilesInfo$.html">FilesInfo
API</a> for
details.</p>
<p>A more advanced version of <tt class="docutils literal"><span class="pre">FileFunction.cached</span></tt> passes a data
structure of type
<a class="reference external" href="../api/sbt/ChangeReport.html">ChangeReport</a>
describing the changes to input and output files since the last
evaluation. This version of <tt class="docutils literal"><span class="pre">cached</span></tt> also expects the set of files
generated as output to be the result of the evaluated function.</p>
</div>
</div>
<div class="section" id="extending-sbt">
<h2>Extending sbt<a class="headerlink" href="#extending-sbt" title="Permalink to this headline">¶</a></h2>
<div class="section" id="how-can-i-add-a-new-configuration">
<h3>How can I add a new configuration?<a class="headerlink" href="#how-can-i-add-a-new-configuration" title="Permalink to this headline">¶</a></h3>
<p>The following example demonstrates adding a new set of compilation
settings and tasks to a new configuration called <tt class="docutils literal"><span class="pre">samples</span></tt>. The
sources for this configuration go in <tt class="docutils literal"><span class="pre">src/samples/scala/</span></tt>. Unspecified
settings delegate to those defined for the <tt class="docutils literal"><span class="pre">compile</span></tt> configuration.
For example, if <tt class="docutils literal"><span class="pre">scalacOptions</span></tt> are not overridden for <tt class="docutils literal"><span class="pre">samples</span></tt>,
the options for the main sources are used.</p>
<p>Options specific to <tt class="docutils literal"><span class="pre">samples</span></tt> may be declared like:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">scalacOptions</span> <span class="n">in</span> <span class="nc">Samples</span> <span class="o">+=</span> <span class="s">&quot;-deprecation&quot;</span>
</pre></div>
</div>
<p>This uses the main options as base options because of <tt class="docutils literal"><span class="pre">+=</span></tt>. Use <tt class="docutils literal"><span class="pre">:=</span></tt>
to ignore the main options:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">scalacOptions</span> <span class="n">in</span> <span class="nc">Samples</span> <span class="o">:=</span> <span class="s">&quot;-deprecation&quot;</span> <span class="o">::</span> <span class="nc">Nil</span>
</pre></div>
</div>
<p>The example adds all of the usual compilation related settings and tasks
to <tt class="docutils literal"><span class="pre">samples</span></tt>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">samples</span><span class="k">:</span><span class="kt">run</span>
<span class="n">samples</span><span class="k">:</span><span class="kt">run-main</span>
<span class="n">samples</span><span class="k">:</span><span class="kt">compile</span>
<span class="n">samples</span><span class="k">:</span><span class="kt">console</span>
<span class="n">samples</span><span class="k">:</span><span class="kt">console-quick</span>
<span class="n">samples</span><span class="k">:</span><span class="kt">scalac-options</span>
<span class="n">samples</span><span class="k">:</span><span class="kt">full-classpath</span>
<span class="n">samples</span><span class="k">:</span><span class="kt">package</span>
<span class="n">samples</span><span class="k">:</span><span class="kt">package-src</span>
<span class="o">...</span>
</pre></div>
</div>
<div class="section" id="example-of-adding-a-new-configuration">
<h4>Example of adding a new configuration<a class="headerlink" href="#example-of-adding-a-new-configuration" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">project/Sample.scala</span></tt></p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">import</span> <span class="nn">sbt._</span>
<span class="k">import</span> <span class="nn">Keys._</span>

<span class="k">object</span> <span class="nc">Sample</span> <span class="k">extends</span> <span class="nc">Build</span> <span class="o">{</span>
     <span class="c1">// defines a new configuration &quot;samples&quot; that will delegate to &quot;compile&quot;</span>
   <span class="k">lazy</span> <span class="k">val</span> <span class="nc">Samples</span> <span class="k">=</span> <span class="n">config</span><span class="o">(</span><span class="s">&quot;samples&quot;</span><span class="o">)</span> <span class="n">extend</span><span class="o">(</span><span class="nc">Compile</span><span class="o">)</span>

     <span class="c1">// defines the project to have the &quot;samples&quot; configuration</span>
   <span class="k">lazy</span> <span class="k">val</span> <span class="n">p</span> <span class="k">=</span> <span class="nc">Project</span><span class="o">(</span><span class="s">&quot;p&quot;</span><span class="o">,</span> <span class="n">file</span><span class="o">(</span><span class="s">&quot;.&quot;</span><span class="o">))</span>
      <span class="o">.</span><span class="n">configs</span><span class="o">(</span><span class="nc">Samples</span><span class="o">)</span>
      <span class="o">.</span><span class="n">settings</span><span class="o">(</span><span class="n">sampleSettings</span> <span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">)</span>

   <span class="k">def</span> <span class="n">sampleSettings</span> <span class="k">=</span>
        <span class="c1">// adds the default compile/run/... tasks in &quot;samples&quot;</span>
      <span class="n">inConfig</span><span class="o">(</span><span class="nc">Samples</span><span class="o">)(</span><span class="nc">Defaults</span><span class="o">.</span><span class="n">configSettings</span><span class="o">)</span> <span class="o">++</span>
      <span class="nc">Seq</span><span class="o">(</span>
        <span class="c1">// (optional) makes &quot;test:compile&quot; depend on &quot;samples:compile&quot;</span>
         <span class="n">compile</span> <span class="n">in</span> <span class="nc">Test</span> <span class="o">&lt;&lt;=</span> <span class="n">compile</span> <span class="n">in</span> <span class="nc">Test</span> <span class="n">dependsOn</span> <span class="o">(</span><span class="n">compile</span> <span class="n">in</span> <span class="nc">Samples</span><span class="o">)</span>
      <span class="o">)</span> <span class="o">++</span>
        <span class="c1">// (optional) declare that the samples binary and</span>
        <span class="c1">// source jars should be published</span>
      <span class="n">publishArtifact</span><span class="o">(</span><span class="n">packageBin</span><span class="o">)</span> <span class="o">++</span>
      <span class="n">publishArtifact</span><span class="o">(</span><span class="n">packageSrc</span><span class="o">)</span>

   <span class="k">def</span> <span class="n">publishArtifact</span><span class="o">(</span><span class="n">task</span><span class="k">:</span> <span class="kt">TaskKey</span><span class="o">[</span><span class="kt">File</span><span class="o">])</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">Setting</span><span class="o">[</span><span class="k">_</span><span class="o">]]</span> <span class="k">=</span>
      <span class="n">addArtifact</span><span class="o">(</span><span class="n">artifact</span> <span class="n">in</span> <span class="o">(</span><span class="nc">Samples</span><span class="o">,</span> <span class="n">task</span><span class="o">),</span> <span class="n">task</span> <span class="n">in</span> <span class="nc">Samples</span><span class="o">).</span><span class="n">settings</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-do-i-add-a-test-configuration">
<h3>How do I add a test configuration?<a class="headerlink" href="#how-do-i-add-a-test-configuration" title="Permalink to this headline">¶</a></h3>
<p>See the <tt class="docutils literal"><span class="pre">Additional</span> <span class="pre">test</span> <span class="pre">configurations</span></tt> section of :doc`/Detailed-Topics/Testing`.</p>
</div>
<div class="section" id="how-can-i-create-a-custom-run-task-in-addition-to-run">
<h3>How can I create a custom run task, in addition to <tt class="docutils literal"><span class="pre">run</span></tt>?<a class="headerlink" href="#how-can-i-create-a-custom-run-task-in-addition-to-run" title="Permalink to this headline">¶</a></h3>
<p>This answer is extracted from a <a class="reference external" href="http://groups.google.com/group/simple-build-tool/browse_thread/thread/4c28ee5b7e18b46a/">mailing list
discussion</a>.</p>
<p>Read the Getting Started Guide up to <a class="reference internal" href="Getting-Started/Custom-Settings.html"><em>custom settings</em></a> for background.</p>
<p>A basic run task is created by:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// this lazy val has to go in a full configuration</span>
<span class="k">lazy</span> <span class="k">val</span> <span class="n">myRunTask</span> <span class="k">=</span> <span class="nc">TaskKey</span><span class="o">[</span><span class="kt">Unit</span><span class="o">](</span><span class="s">&quot;my-run-task&quot;</span><span class="o">)</span>

<span class="c1">// this can go either in a `build.sbt` or the settings member</span>
<span class="c1">//   of a Project in a full configuration</span>
<span class="n">fullRunTask</span><span class="o">(</span><span class="n">myRunTask</span><span class="o">,</span> <span class="nc">Test</span><span class="o">,</span> <span class="s">&quot;foo.Foo&quot;</span><span class="o">,</span> <span class="s">&quot;arg1&quot;</span><span class="o">,</span> <span class="s">&quot;arg2&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>or, if you really want to define it inline (as in a basic <tt class="docutils literal"><span class="pre">build.sbt</span></tt>
file):</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">fullRunTask</span><span class="o">(</span><span class="nc">TaskKey</span><span class="o">[</span><span class="kt">Unit</span><span class="o">](</span><span class="s">&quot;my-run-task&quot;</span><span class="o">),</span> <span class="nc">Test</span><span class="o">,</span> <span class="s">&quot;foo.Foo&quot;</span><span class="o">,</span> <span class="s">&quot;arg1&quot;</span><span class="o">,</span> <span class="s">&quot;arg2&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>If you want to be able to supply arguments on the command line, replace
<tt class="docutils literal"><span class="pre">TaskKey</span></tt> with <tt class="docutils literal"><span class="pre">InputKey</span></tt> and <tt class="docutils literal"><span class="pre">fullRunTask</span></tt> with
<tt class="docutils literal"><span class="pre">fullRunInputTask</span></tt>. The <tt class="docutils literal"><span class="pre">Test</span></tt> part can be replaced with another
configuration, such as <tt class="docutils literal"><span class="pre">Compile</span></tt>, to use that configuration's
classpath.</p>
<p>This run task can be configured individually by specifying the task key
in the scope. For example:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">fork</span> <span class="n">in</span> <span class="n">myRunTask</span> <span class="o">:=</span> <span class="kc">true</span>

<span class="n">javaOptions</span> <span class="n">in</span> <span class="n">myRunTask</span> <span class="o">+=</span> <span class="s">&quot;-Xmx6144m&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="how-can-i-delegate-settings-from-one-task-to-another-task">
<h3>How can I delegate settings from one task to another task?<a class="headerlink" href="#how-can-i-delegate-settings-from-one-task-to-another-task" title="Permalink to this headline">¶</a></h3>
<p>Settings <a class="reference internal" href="Getting-Started/Scopes.html"><em>scoped</em></a> to one task can fall back to
another task if undefined in the first task. This is called delegation.</p>
<p>The following key definitions specify that settings for <tt class="docutils literal"><span class="pre">myRun</span></tt>
delegate to <tt class="docutils literal"><span class="pre">aRun</span></tt></p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">aRun</span> <span class="k">=</span> <span class="nc">TaskKey</span><span class="o">[</span><span class="kt">Unit</span><span class="o">](</span><span class="s">&quot;a-run&quot;</span><span class="o">,</span> <span class="s">&quot;A run task.&quot;</span><span class="o">)</span>

<span class="c1">//   The last parameter to TaskKey.apply here is a repeated one</span>
<span class="k">val</span> <span class="n">myRun</span> <span class="k">=</span> <span class="nc">TaskKey</span><span class="o">[</span><span class="kt">Unit</span><span class="o">](</span><span class="s">&quot;my-run&quot;</span><span class="o">,</span> <span class="s">&quot;Custom run task.&quot;</span><span class="o">,</span> <span class="n">aRun</span><span class="o">)</span>
</pre></div>
</div>
<p>In use, this looks like:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// Make the run task as before.</span>
<span class="n">fullRunTask</span><span class="o">(</span><span class="n">myRun</span><span class="o">,</span> <span class="nc">Compile</span><span class="o">,</span> <span class="s">&quot;pkg.Main&quot;</span><span class="o">,</span> <span class="s">&quot;arg1&quot;</span><span class="o">,</span> <span class="s">&quot;arg2&quot;</span><span class="o">)</span>

<span class="c1">// If fork in myRun is not explicitly set,</span>
<span class="c1">//   then this also configures myRun to fork.</span>
<span class="c1">// If fork in myRun is set, it overrides this setting</span>
<span class="c1">//   because it is more specific.</span>
<span class="n">fork</span> <span class="n">in</span> <span class="n">aRun</span> <span class="o">:=</span> <span class="kc">true</span>

<span class="c1">// Appends &quot;-Xmx2G&quot; to the current options for myRun.</span>
<span class="c1">//   Because we haven&#39;t defined them explicitly,</span>
<span class="c1">//   the current options are delegated to aRun.</span>
<span class="c1">//   So, this says to use the same options as aRun</span>
<span class="c1">//   plus -Xmx2G.</span>
<span class="n">javaOptions</span> <span class="n">in</span> <span class="n">myRun</span> <span class="o">+=</span> <span class="s">&quot;-Xmx2G&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="how-should-i-express-a-dependency-on-an-outside-tool-such-as-proguard">
<h3>How should I express a dependency on an outside tool such as proguard?<a class="headerlink" href="#how-should-i-express-a-dependency-on-an-outside-tool-such-as-proguard" title="Permalink to this headline">¶</a></h3>
<p>Tool dependencies are used to implement a task and are not needed by
project source code. These dependencies can be declared in their own
configuration and classpaths. These are the steps:</p>
<ol class="arabic simple">
<li>Define a new <a class="reference internal" href="Dormant/Configurations.html"><em>configuration</em></a>.</li>
<li>Declare the tool <a class="reference internal" href="Detailed-Topics/Library-Management.html"><em>dependencies</em></a> in that
configuration.</li>
<li>Define a classpath that pulls the dependencies from the <a class="reference internal" href="Detailed-Topics/Update-Report.html"><em>Update Report</em></a> produced by <tt class="docutils literal"><span class="pre">update</span></tt>.</li>
<li>Use the classpath to implement the task.</li>
</ol>
<p>As an example, consider a <tt class="docutils literal"><span class="pre">proguard</span></tt> task. This task needs the
ProGuard jars in order to run the tool. Assuming a new configuration
defined in the full build definition (#1):</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="nc">ProguardConfig</span> <span class="k">=</span> <span class="n">config</span><span class="o">(</span><span class="s">&quot;proguard&quot;</span><span class="o">)</span> <span class="n">hide</span>
</pre></div>
</div>
<p>the following are settings that implement #2-#4:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// Add proguard as a dependency in the custom configuration.</span>
<span class="c1">//  This keeps it separate from project dependencies.</span>
<span class="n">libraryDependencies</span> <span class="o">+=</span>
   <span class="s">&quot;net.sf.proguard&quot;</span> <span class="o">%</span> <span class="s">&quot;proguard&quot;</span> <span class="o">%</span> <span class="s">&quot;4.4&quot;</span> <span class="o">%</span> <span class="nc">ProguardConfig</span><span class="o">.</span><span class="n">name</span>

<span class="c1">// Extract the dependencies from the UpdateReport.</span>
<span class="n">managedClasspath</span> <span class="n">in</span> <span class="n">proguard</span> <span class="o">&lt;&lt;=</span>
   <span class="o">(</span><span class="n">classpathTypes</span> <span class="n">in</span> <span class="n">proguard</span><span class="o">,</span> <span class="n">update</span><span class="o">)</span> <span class="n">map</span> <span class="o">{</span> <span class="o">(</span><span class="n">ct</span><span class="o">,</span> <span class="n">report</span><span class="o">)</span> <span class="k">=&gt;</span>
     <span class="nc">Classpaths</span><span class="o">.</span><span class="n">managedJars</span><span class="o">(</span><span class="n">proguardConfig</span><span class="o">,</span> <span class="n">ct</span><span class="o">,</span> <span class="n">report</span><span class="o">)</span>
   <span class="o">}</span>

<span class="c1">// Use the dependencies in a task, typically by putting them</span>
<span class="c1">//  in a ClassLoader and reflectively calling an appropriate</span>
<span class="c1">//  method.</span>
<span class="n">proguard</span> <span class="o">&lt;&lt;=</span> <span class="n">managedClasspath</span> <span class="n">in</span> <span class="n">proguard</span> <span class="o">{</span> <span class="o">(</span><span class="n">cp</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">File</span><span class="o">]</span> <span class="k">=&gt;</span>
  <span class="c1">// ... do something with &#39;cp&#39;, which includes proguard ...</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="how-would-i-change-sbt-s-classpath-dynamically">
<h3>How would I change sbt's classpath dynamically?<a class="headerlink" href="#how-would-i-change-sbt-s-classpath-dynamically" title="Permalink to this headline">¶</a></h3>
<p>It is possible to register additional jars that will be placed on sbt's
classpath (since version 0.10.1). Through
<a class="reference external" href="../api/sbt/State$.html">State</a>, it
is possible to obtain a
<a class="reference external" href="../api/xsbti/ComponentProvider.html">xsbti.ComponentProvider</a>,
which manages application components. Components are groups of files in
the <tt class="docutils literal"><span class="pre">~/.sbt/boot/</span></tt> directory and, in this case, the application is
sbt. In addition to the base classpath, components in the &quot;extra&quot;
component are included on sbt's classpath.</p>
<p>(Note: the additional components on an application's classpath are
declared by the <tt class="docutils literal"><span class="pre">components</span></tt> property in the <tt class="docutils literal"><span class="pre">[main]</span></tt> section of the
launcher configuration file <tt class="docutils literal"><span class="pre">boot.properties</span></tt>.)</p>
<p>Because these components are added to the <tt class="docutils literal"><span class="pre">~/.sbt/boot/</span></tt> directory and
<tt class="docutils literal"><span class="pre">~/.sbt/boot/</span></tt> may be read-only, this can fail. In this case, the user
has generally intentionally set sbt up this way, so error recovery is
not typically necessary (just a short error message explaining the
situation.)</p>
<div class="section" id="example-of-dynamic-classpath-augmentation">
<h4>Example of dynamic classpath augmentation<a class="headerlink" href="#example-of-dynamic-classpath-augmentation" title="Permalink to this headline">¶</a></h4>
<p>The following code can be used where a <tt class="docutils literal"><span class="pre">State</span> <span class="pre">=&gt;</span> <span class="pre">State</span></tt> is required,
such as in the <tt class="docutils literal"><span class="pre">onLoad</span></tt> setting (described below) or in a
<a class="reference internal" href="Extending/Commands.html"><em>command</em></a>. It adds some files to the &quot;extra&quot; component and
reloads sbt if they were not already added. Note that reloading will
drop the user's session state.</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">def</span> <span class="n">augment</span><span class="o">(</span><span class="n">extra</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">File</span><span class="o">])(</span><span class="n">s</span><span class="k">:</span> <span class="kt">State</span><span class="o">)</span><span class="k">:</span> <span class="kt">State</span> <span class="o">=</span>
<span class="o">{</span>
    <span class="c1">// Get the component provider</span>
  <span class="k">val</span> <span class="n">cs</span><span class="k">:</span> <span class="kt">xsbti.ComponentProvider</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">components</span><span class="o">()</span>

    <span class="c1">// Adds the files in &#39;extra&#39; to the &quot;extra&quot; component</span>
    <span class="c1">//   under an exclusive machine-wide lock.</span>
    <span class="c1">//   The returned value is &#39;true&#39; if files were actually copied and &#39;false&#39;</span>
    <span class="c1">//   if the target files already exists (based on name only).</span>
  <span class="k">val</span> <span class="n">copied</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">locked</span><span class="o">(</span><span class="n">cs</span><span class="o">.</span><span class="n">lockFile</span><span class="o">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">addToComponent</span><span class="o">(</span><span class="s">&quot;extra&quot;</span><span class="o">,</span> <span class="n">extra</span><span class="o">.</span><span class="n">toArray</span><span class="o">))</span>

    <span class="c1">// If files were copied, reload so that we use the new classpath.</span>
  <span class="k">if</span><span class="o">(</span><span class="n">copied</span><span class="o">)</span> <span class="n">s</span><span class="o">.</span><span class="n">reload</span> <span class="k">else</span> <span class="n">s</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-can-i-take-action-when-the-project-is-loaded-or-unloaded">
<h3>How can I take action when the project is loaded or unloaded?<a class="headerlink" href="#how-can-i-take-action-when-the-project-is-loaded-or-unloaded" title="Permalink to this headline">¶</a></h3>
<p>The single, global setting <tt class="docutils literal"><span class="pre">onLoad</span></tt> is of type <tt class="docutils literal"><span class="pre">State</span> <span class="pre">=&gt;</span> <span class="pre">State</span></tt> (see
<a class="reference internal" href="Extending/Build-State.html"><em>State and actions</em></a>) and is executed once, after all projects are built and
loaded. There is a similar hook <tt class="docutils literal"><span class="pre">onUnload</span></tt> for when a project is
unloaded. Project unloading typically occurs as a result of a <tt class="docutils literal"><span class="pre">reload</span></tt>
command or a <tt class="docutils literal"><span class="pre">set</span></tt> command. Because the <tt class="docutils literal"><span class="pre">onLoad</span></tt> and <tt class="docutils literal"><span class="pre">onUnload</span></tt>
hooks are global, modifying this setting typically involves composing a
new function with the previous value. The following example shows the
basic structure of defining <tt class="docutils literal"><span class="pre">onLoad</span></tt>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// Compose our new function &#39;f&#39; with the existing transformation.</span>
<span class="o">{</span>
  <span class="k">val</span> <span class="n">f</span><span class="k">:</span> <span class="kt">State</span> <span class="o">=&gt;</span> <span class="nc">State</span> <span class="k">=</span> <span class="o">...</span>
  <span class="n">onLoad</span> <span class="n">in</span> <span class="nc">Global</span> <span class="o">~=</span> <span class="o">(</span><span class="n">f</span> <span class="n">compose</span> <span class="k">_</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="section" id="example-of-project-load-unload-hooks">
<h4>Example of project load/unload hooks<a class="headerlink" href="#example-of-project-load-unload-hooks" title="Permalink to this headline">¶</a></h4>
<p>The following example maintains a count of the number of times a project
has been loaded and prints that number:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="o">{</span>
  <span class="c1">// the key for the current count</span>
  <span class="k">val</span> <span class="n">key</span> <span class="k">=</span> <span class="nc">AttributeKey</span><span class="o">[</span><span class="kt">Int</span><span class="o">](</span><span class="s">&quot;load-count&quot;</span><span class="o">)</span>
  <span class="c1">// the State transformer</span>
  <span class="k">val</span> <span class="n">f</span> <span class="k">=</span> <span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">State</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">previous</span> <span class="k">=</span> <span class="n">s</span> <span class="n">get</span> <span class="n">key</span> <span class="n">getOrElse</span> <span class="mi">0</span>
    <span class="n">println</span><span class="o">(</span><span class="s">&quot;Project load count: &quot;</span> <span class="o">+</span> <span class="n">previous</span><span class="o">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">previous</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span>
  <span class="o">}</span>
  <span class="n">onLoad</span> <span class="n">in</span> <span class="nc">Global</span> <span class="o">~=</span> <span class="o">(</span><span class="n">f</span> <span class="n">compose</span> <span class="k">_</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="errors">
<h2>Errors<a class="headerlink" href="#errors" title="Permalink to this headline">¶</a></h2>
<div class="section" id="type-error-found-initialize-task-string-required-initialize-string-or-found-taskkey-string-required-initialize-string">
<h3>Type error, found: <tt class="docutils literal"><span class="pre">Initialize[Task[String]]</span></tt>, required: <tt class="docutils literal"><span class="pre">Initialize[String]</span></tt> or found: <tt class="docutils literal"><span class="pre">TaskKey[String]</span></tt> required: <tt class="docutils literal"><span class="pre">Initialize[String]</span></tt><a class="headerlink" href="#type-error-found-initialize-task-string-required-initialize-string-or-found-taskkey-string-required-initialize-string" title="Permalink to this headline">¶</a></h3>
<p>This means that you are trying to supply a task when defining a setting
key. See <a class="reference internal" href="Getting-Started/Basic-Def.html"><em>.sbt build definition</em></a> for the
difference between task and setting keys, and
<a class="reference internal" href="Getting-Started/More-About-Settings.html"><em>more about settings</em></a>
for more on how to define one key in terms of other keys.</p>
<p>Setting keys are only evaluated once, on project load, while tasks are
evaluated repeatedly. Defining a setting in terms of a task does not
make sense because tasks must be re-evaluated every time.</p>
<p>One way to get a task when you didn't want one is to use the <tt class="docutils literal"><span class="pre">map</span></tt>
method instead of the <tt class="docutils literal"><span class="pre">apply</span></tt> method.
<a class="reference internal" href="Getting-Started/More-About-Settings.html"><em>More about settings</em></a> covers this topic as well.</p>
<p>Suppose we define these keys, in <tt class="docutils literal"><span class="pre">./project/Build.scala</span></tt> (For details,
see :doc:/<tt class="docutils literal"><span class="pre">.scala</span> <span class="pre">build</span> <span class="pre">definition</span> <span class="pre">&lt;/Getting-Started/Full-Def&gt;</span></tt>).</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">baseSetting</span> <span class="k">=</span> <span class="nc">SettingKey</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;base-setting&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">derivedSetting</span> <span class="k">=</span> <span class="nc">SettingKey</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;derived-setting&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">baseTask</span> <span class="k">=</span> <span class="nc">TaskKey</span><span class="o">[</span><span class="kt">Long</span><span class="o">](</span><span class="s">&quot;base-task&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">derivedTask</span> <span class="k">=</span> <span class="nc">TaskKey</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;derived-task&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>Let's define an initialization for <tt class="docutils literal"><span class="pre">base-setting</span></tt> and <tt class="docutils literal"><span class="pre">base-task</span></tt>.
We will then use these as inputs to other setting and task
initializations.</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">baseSetting</span> <span class="o">:=</span> <span class="s">&quot;base setting&quot;</span>

<span class="n">baseTask</span> <span class="o">:=</span> <span class="o">{</span> <span class="nc">System</span><span class="o">.</span><span class="n">currentTimeMillis</span><span class="o">()</span> <span class="o">}</span>
</pre></div>
</div>
<p>Then this will not work:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// error: found: Initialize[Task[String]], required: Initialize[String]</span>
<span class="n">derivedSetting</span> <span class="o">&lt;&lt;=</span> <span class="n">baseSetting</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">toString</span><span class="o">),</span>
<span class="n">derivedSetting</span> <span class="o">&lt;&lt;=</span> <span class="n">baseTask</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">toString</span><span class="o">),</span>
<span class="n">derivedSetting</span> <span class="o">&lt;&lt;=</span> <span class="o">(</span><span class="n">baseSetting</span><span class="o">,</span> <span class="n">baseTask</span><span class="o">).</span><span class="n">map</span><span class="o">((</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">toString</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">toString</span><span class="o">),</span>
</pre></div>
</div>
<p>One or more settings can be used as inputs to initialize another
setting, using the <tt class="docutils literal"><span class="pre">apply</span></tt> method.</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">derivedSetting</span> <span class="o">&lt;&lt;=</span> <span class="n">baseSetting</span><span class="o">.</span><span class="n">apply</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>

<span class="n">derivedSetting</span> <span class="o">&lt;&lt;=</span> <span class="n">baseSetting</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>

<span class="n">derivedSetting</span> <span class="o">&lt;&lt;=</span> <span class="o">(</span><span class="n">baseSetting</span><span class="o">,</span> <span class="n">baseSetting</span><span class="o">)((</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">toString</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>
</pre></div>
</div>
<p>Both settings and tasks can be used to initialize a task, using the
<tt class="docutils literal"><span class="pre">map</span></tt> method.</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">derivedTask</span> <span class="o">&lt;&lt;=</span> <span class="n">baseSetting</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>

<span class="n">derivedTask</span> <span class="o">&lt;&lt;=</span> <span class="n">baseTask</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>

<span class="n">derivedTask</span> <span class="o">&lt;&lt;=</span> <span class="o">(</span><span class="n">baseSetting</span><span class="o">,</span> <span class="n">baseTask</span><span class="o">).</span><span class="n">map</span><span class="o">((</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">toString</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>
</pre></div>
</div>
<p>But, it is a compile time error to use <tt class="docutils literal"><span class="pre">map</span></tt> to initialize a setting:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// error: found: Initialize[Task[String]], required: Initialize[String]</span>
<span class="n">derivedSetting</span> <span class="o">&lt;&lt;=</span> <span class="n">baseSetting</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">toString</span><span class="o">),</span>
<span class="n">derivedSetting</span> <span class="o">&lt;&lt;=</span> <span class="n">baseTask</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">toString</span><span class="o">),</span>
<span class="n">derivedSetting</span> <span class="o">&lt;&lt;=</span> <span class="o">(</span><span class="n">baseSetting</span><span class="o">,</span> <span class="n">baseTask</span><span class="o">).</span><span class="n">map</span><span class="o">((</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">toString</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">toString</span><span class="o">),</span>
</pre></div>
</div>
<p>It is not allowed to use a task as input to a settings initialization
with <tt class="docutils literal"><span class="pre">apply</span></tt>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// error: value apply is not a member of TaskKey[Long]</span>
<span class="n">derivedSetting</span> <span class="o">&lt;&lt;=</span> <span class="n">baseTask</span><span class="o">.</span><span class="n">apply</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>

<span class="c1">// error: value apply is not a member of TaskKey[Long]</span>
<span class="n">derivedTask</span> <span class="o">&lt;&lt;=</span> <span class="n">baseTask</span><span class="o">.</span><span class="n">apply</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>

<span class="c1">// error: value apply is not a member of (sbt.SettingKey[String], sbt.TaskKey[Long])</span>
<span class="n">derivedTask</span> <span class="o">&lt;&lt;=</span> <span class="o">(</span><span class="n">baseSetting</span><span class="o">,</span> <span class="n">baseTask</span><span class="o">).</span><span class="n">apply</span><span class="o">((</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">toString</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>
</pre></div>
</div>
<p>Finally, it is not directly possible to use <tt class="docutils literal"><span class="pre">apply</span></tt> to initialize a
task.</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// error: found String, required Task[String]</span>
<span class="n">derivedTask</span> <span class="o">&lt;&lt;=</span> <span class="n">baseSetting</span><span class="o">.</span><span class="n">apply</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="on-project-load-reference-to-uninitialized-setting">
<h3>On project load, &quot;Reference to uninitialized setting&quot;<a class="headerlink" href="#on-project-load-reference-to-uninitialized-setting" title="Permalink to this headline">¶</a></h3>
<p>Setting initializers are executed in order. If the initialization of a
setting depends on other settings that has not been initialized, sbt
will stop loading. This can happen using <tt class="docutils literal"><span class="pre">+=</span></tt>, <tt class="docutils literal"><span class="pre">++=</span></tt>, <tt class="docutils literal"><span class="pre">&lt;&lt;=</span></tt>,
<tt class="docutils literal"><span class="pre">&lt;+=</span></tt>, <tt class="docutils literal"><span class="pre">&lt;++=</span></tt>, and <tt class="docutils literal"><span class="pre">~=</span></tt>. (To understand those methods,
<a class="reference internal" href="Getting-Started/More-About-Settings.html"><em>read this</em></a>.)</p>
<p>In this example, we try to append a library to <tt class="docutils literal"><span class="pre">libraryDependencies</span></tt>
before it is initialized with an empty sequence.</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">object</span> <span class="nc">MyBuild</span> <span class="k">extends</span> <span class="nc">Build</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">root</span> <span class="k">=</span> <span class="nc">Project</span><span class="o">(</span><span class="n">id</span> <span class="k">=</span> <span class="s">&quot;root&quot;</span><span class="o">,</span> <span class="n">base</span> <span class="k">=</span> <span class="n">file</span><span class="o">(</span><span class="s">&quot;.&quot;</span><span class="o">),</span>
    <span class="n">settings</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
      <span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">&quot;commons-io&quot;</span> <span class="o">%</span> <span class="s">&quot;commons-io&quot;</span> <span class="o">%</span> <span class="s">&quot;1.4&quot;</span> <span class="o">%</span> <span class="s">&quot;test&quot;</span>
    <span class="o">)</span>
  <span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>To correct this, include the default settings, which includes
<tt class="docutils literal"><span class="pre">libraryDependencies</span> <span class="pre">:=</span> <span class="pre">Seq()</span></tt>.</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">settings</span> <span class="k">=</span> <span class="nc">Defaults</span><span class="o">.</span><span class="n">defaultSettings</span> <span class="o">++</span> <span class="nc">Seq</span><span class="o">(</span>
  <span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">&quot;commons-io&quot;</span> <span class="o">%</span> <span class="s">&quot;commons-io&quot;</span> <span class="o">%</span> <span class="s">&quot;1.4&quot;</span> <span class="o">%</span> <span class="s">&quot;test&quot;</span>
<span class="o">)</span>
</pre></div>
</div>
<p>A more subtle variation of this error occurs when using <a class="reference internal" href="Getting-Started/Scopes.html"><em>scoped settings</em></a>.</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// error: Reference to uninitialized setting</span>
<span class="n">settings</span> <span class="k">=</span> <span class="nc">Defaults</span><span class="o">.</span><span class="n">defaultSettings</span> <span class="o">++</span> <span class="nc">Seq</span><span class="o">(</span>
  <span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">&quot;commons-io&quot;</span> <span class="o">%</span> <span class="s">&quot;commons-io&quot;</span> <span class="o">%</span> <span class="s">&quot;1.2&quot;</span> <span class="o">%</span> <span class="s">&quot;test&quot;</span><span class="o">,</span>
  <span class="n">fullClasspath</span> <span class="o">~=</span> <span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">filterNot</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">contains</span><span class="o">(</span><span class="s">&quot;commons-io&quot;</span><span class="o">)))</span>
<span class="o">)</span>
</pre></div>
</div>
<p>Generally, all of the update operators can be expressed in terms of
<tt class="docutils literal"><span class="pre">&lt;&lt;=</span></tt>. To better understand the error, we can rewrite the setting as:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// error: Reference to uninitialized setting</span>
<span class="n">fullClasspath</span> <span class="o">&lt;&lt;=</span> <span class="o">(</span><span class="n">fullClasspath</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">filterNot</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">contains</span><span class="o">(</span><span class="s">&quot;commons-io&quot;</span><span class="o">)))</span>
</pre></div>
</div>
<p>This setting varies between the test and compile scopes. The solution is
use the scoped setting, both as the input to the initializer, and the
setting that we update.</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">fullClasspath</span> <span class="n">in</span> <span class="nc">Compile</span> <span class="o">&lt;&lt;=</span> <span class="o">(</span><span class="n">fullClasspath</span> <span class="n">in</span> <span class="nc">Compile</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">filterNot</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">contains</span><span class="o">(</span><span class="s">&quot;commons-io&quot;</span><span class="o">)))</span>

<span class="c1">// or equivalently</span>
<span class="n">fullClasspath</span> <span class="n">in</span> <span class="nc">Compile</span> <span class="o">~=</span> <span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">filterNot</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">contains</span><span class="o">(</span><span class="s">&quot;commons-io&quot;</span><span class="o">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="dependency-management">
<h2>Dependency Management<a class="headerlink" href="#dependency-management" title="Permalink to this headline">¶</a></h2>
<div class="section" id="how-do-i-resolve-a-checksum-error">
<h3>How do I resolve a checksum error?<a class="headerlink" href="#how-do-i-resolve-a-checksum-error" title="Permalink to this headline">¶</a></h3>
<p>This error occurs when the published checksum, such as a sha1 or md5
hash, differs from the checksum computed for a downloaded artifact, such
as a jar or pom.xml. An example of such an error is:</p>
<div class="highlight-scala"><pre>[warn]  problem while downloading module descriptor:
http://repo1.maven.org/maven2/commons-fileupload/commons-fileupload/1.2.2/commons-fileupload-1.2.2.pom:
invalid sha1: expected=ad3fda4adc95eb0d061341228cc94845ddb9a6fe computed=0ce5d4a03b07c8b00ab60252e5cacdc708a4e6d8 (1070ms)</pre>
</div>
<p>The invalid checksum should generally be reported to the repository
owner (as <a class="reference external" href="https://issues.sonatype.org/browse/MVNCENTRAL-46">was done</a>
for the above error). In the meantime, you can temporarily disable
checking with the following setting:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">checksums</span> <span class="n">in</span> <span class="n">update</span> <span class="o">:=</span> <span class="nc">Nil</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="Detailed-Topics/Library-Management.html"><em>Library Management</em></a> for details.</p>
</div>
<div class="section" id="i-ve-added-a-plugin-and-now-my-cross-compilations-fail">
<h3>I've added a plugin, and now my cross-compilations fail!<a class="headerlink" href="#i-ve-added-a-plugin-and-now-my-cross-compilations-fail" title="Permalink to this headline">¶</a></h3>
<p>This problem crops up frequently. Plugins are only published for the
Scala version that sbt uses (currently, 2.9.1). You can still <em>use</em>
plugins during cross-compilation, because sbt only looks for a 2.9.1
version of the plugin.</p>
<p><strong>... unless you specify the plugin in the wrong place!</strong></p>
<p>A typical mistake is to put global plugin definitions in
<tt class="docutils literal"><span class="pre">~/.sbt/plugins.sbt</span></tt>. <strong>THIS IS WRONG.</strong> <tt class="docutils literal"><span class="pre">.sbt</span></tt> files in <tt class="docutils literal"><span class="pre">~/.sbt</span></tt>
are loaded for <em>each</em> build--that is, for <em>each</em> cross-compilation. So,
if you build for Scala 2.9.0, sbt will try to find a version of the
plugin that's compiled for 2.9.0--and it usually won't. That's because
it doesn't <em>know</em> the dependency is a plugin.</p>
<p>To tell sbt that the dependency is an sbt plugin, make sure you define
your global plugins in a <tt class="docutils literal"><span class="pre">.sbt</span></tt> file in <tt class="docutils literal"><span class="pre">~/.sbt/plugins/</span></tt>. sbt knows
that files in <tt class="docutils literal"><span class="pre">~/.sbt/plugins</span></tt> are only to be used by sbt itself, not
as part of the general build definition. If you define your plugins in a
file under <em>that</em> directory, they won't foul up your cross-compilations.
Any file name ending in <tt class="docutils literal"><span class="pre">.sbt</span></tt> will do, but most people use
<tt class="docutils literal"><span class="pre">~/.sbt/plugins/build.sbt</span></tt> or <tt class="docutils literal"><span class="pre">~/.sbt/plugins/plugins.sbt</span></tt>. ##
Miscellaneous</p>
</div>
<div class="section" id="how-do-i-use-the-scala-interpreter-in-my-code">
<h3>How do I use the Scala interpreter in my code?<a class="headerlink" href="#how-do-i-use-the-scala-interpreter-in-my-code" title="Permalink to this headline">¶</a></h3>
<p>sbt runs tests in the same JVM as sbt itself and Scala classes are not
in the same class loader as the application classes. Therefore, when
using the Scala interpreter, it is important to set it up properly to
avoid an error message like:</p>
<div class="highlight-scala"><pre>Failed to initialize compiler: class scala.runtime.VolatileBooleanRef not found.
** Note that as of 2.8 scala does not assume use of the java classpath.
** For the old behavior pass -usejavacp to scala, or if using a Settings
** object programmatically, settings.usejavacp.value = true.</pre>
</div>
<p>The key is to initialize the Settings for the interpreter using
<em>embeddedDefaults</em>. For example:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">settings</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Settings</span>
<span class="n">settings</span><span class="o">.</span><span class="n">embeddedDefaults</span><span class="o">[</span><span class="kt">MyType</span><span class="o">]</span>
<span class="k">val</span> <span class="n">interpreter</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Interpreter</span><span class="o">(</span><span class="n">settings</span><span class="o">,</span> <span class="o">...)</span>
</pre></div>
</div>
<p>Here, MyType is a representative class that should be included on the
interpreter's classpath and in its application class loader. For more
background, see the <a class="reference external" href="https://gist.github.com/404272">original
proposal</a> that resulted in
<em>embeddedDefaults</em> being added.</p>
<p>Similarly, use a representative class as the type argument when using
the <em>break</em> and <em>breakIf</em> methods of <em>ILoop</em>, as in the following
example:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">def</span> <span class="n">x</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
  <span class="k">import</span> <span class="nn">scala.tools.nsc.interpreter.ILoop</span>
  <span class="nc">ILoop</span><span class="o">.</span><span class="n">breakIf</span><span class="o">[</span><span class="kt">MyType</span><span class="o">](</span><span class="n">a</span> <span class="o">!=</span> <span class="n">b</span><span class="o">,</span> <span class="s">&quot;a&quot;</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">,</span> <span class="s">&quot;b&quot;</span> <span class="o">-&gt;</span> <span class="n">b</span> <span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
          <div class="span3"><p class="contents-title">Contents</p>
              <div id="scroller-anchor">
                <div id="scroller">
                  <div id="toc"><ul>
<li><a class="reference internal" href="#">Frequently Asked Questions</a><ul>
<li><a class="reference internal" href="#project-information">Project Information</a><ul>
<li><a class="reference internal" href="#how-do-i-get-help">How do I get help?</a></li>
<li><a class="reference internal" href="#how-do-i-report-a-bug">How do I report a bug?</a></li>
<li><a class="reference internal" href="#how-can-i-help">How can I help?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#to-0-10-migration">0.7 to 0.10+ Migration</a><ul>
<li><a class="reference internal" href="#how-do-i-migrate-from-0-7-to-0-10">How do I migrate from 0.7 to 0.10+?</a></li>
<li><a class="reference internal" href="#where-has-0-7-s-lib-managed-gone">Where has 0.7's <tt class="docutils literal"><span class="pre">lib_managed</span></tt> gone?</a></li>
<li><a class="reference internal" href="#what-are-the-commands-i-can-use-in-version-vs-0-7">What are the commands I can use in 0.12 vs. 0.7?</a></li>
<li><a class="reference internal" href="#why-have-the-resolved-dependencies-in-a-multi-module-project-changed-since-0-7">Why have the resolved dependencies in a multi-module project changed since 0.7?</a></li>
<li><a class="reference internal" href="#my-tests-all-run-really-fast-but-some-are-broken-that-weren-t-in-0-7">My tests all run really fast but some are broken that weren't in 0.7!</a></li>
<li><a class="reference internal" href="#how-do-i-set-log-levels-in-version-vs-0-7">How do I set log levels in 0.12 vs. 0.7?</a></li>
<li><a class="reference internal" href="#what-happened-to-the-web-development-and-web-start-support-since-0-7">What happened to the web development and Web Start support since 0.7?</a></li>
<li><a class="reference internal" href="#how-are-inter-project-dependencies-different-in-version-vs-0-7">How are inter-project dependencies different in 0.12 vs. 0.7?</a></li>
<li><a class="reference internal" href="#where-did-class-object-x-go-since-0-7">Where did class/object X go since 0.7?</a></li>
<li><a class="reference internal" href="#where-can-i-find-plugins-for-version">Where can I find plugins for 0.12?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#my-last-command-didn-t-work-but-i-can-t-see-an-explanation-why">My last command didn't work but I can't see an explanation. Why?</a></li>
<li><a class="reference internal" href="#how-do-i-disable-ansi-codes-in-the-output">How do I disable ansi codes in the output?</a></li>
<li><a class="reference internal" href="#how-can-i-start-a-scala-interpreter-repl-with-sbt-project-configuration-dependencies-etc">How can I start a Scala interpreter (REPL) with sbt project configuration (dependencies, etc.)?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#build-definitions">Build definitions</a><ul>
<li><a class="reference internal" href="#what-are-the-and-methods">What are the <tt class="docutils literal"><span class="pre">:=</span></tt>, <tt class="docutils literal"><span class="pre">~=</span></tt>, <tt class="docutils literal"><span class="pre">&lt;&lt;=</span></tt>, <tt class="docutils literal"><span class="pre">+=</span></tt>, <tt class="docutils literal"><span class="pre">++=</span></tt>, <tt class="docutils literal"><span class="pre">&lt;+=</span></tt>, and <tt class="docutils literal"><span class="pre">&lt;++=</span></tt> methods?</a></li>
<li><a class="reference internal" href="#what-is-the-method">What is the <tt class="docutils literal"><span class="pre">%</span></tt> method?</a></li>
<li><a class="reference internal" href="#what-is-moduleid-project">What is <tt class="docutils literal"><span class="pre">ModuleID</span></tt>, <tt class="docutils literal"><span class="pre">Project</span></tt>, ...?</a></li>
<li><a class="reference internal" href="#how-can-one-key-depend-on-multiple-other-keys">How can one key depend on multiple other keys?</a></li>
<li><a class="reference internal" href="#how-do-i-add-files-to-a-jar-package">How do I add files to a jar package?</a></li>
<li><a class="reference internal" href="#how-can-i-generate-source-code-or-resources">How can I generate source code or resources?</a></li>
<li><a class="reference internal" href="#how-can-a-task-avoid-redoing-work-if-the-input-files-are-unchanged">How can a task avoid redoing work if the input files are unchanged?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extending-sbt">Extending sbt</a><ul>
<li><a class="reference internal" href="#how-can-i-add-a-new-configuration">How can I add a new configuration?</a><ul>
<li><a class="reference internal" href="#example-of-adding-a-new-configuration">Example of adding a new configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-do-i-add-a-test-configuration">How do I add a test configuration?</a></li>
<li><a class="reference internal" href="#how-can-i-create-a-custom-run-task-in-addition-to-run">How can I create a custom run task, in addition to <tt class="docutils literal"><span class="pre">run</span></tt>?</a></li>
<li><a class="reference internal" href="#how-can-i-delegate-settings-from-one-task-to-another-task">How can I delegate settings from one task to another task?</a></li>
<li><a class="reference internal" href="#how-should-i-express-a-dependency-on-an-outside-tool-such-as-proguard">How should I express a dependency on an outside tool such as proguard?</a></li>
<li><a class="reference internal" href="#how-would-i-change-sbt-s-classpath-dynamically">How would I change sbt's classpath dynamically?</a><ul>
<li><a class="reference internal" href="#example-of-dynamic-classpath-augmentation">Example of dynamic classpath augmentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-can-i-take-action-when-the-project-is-loaded-or-unloaded">How can I take action when the project is loaded or unloaded?</a><ul>
<li><a class="reference internal" href="#example-of-project-load-unload-hooks">Example of project load/unload hooks</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#errors">Errors</a><ul>
<li><a class="reference internal" href="#type-error-found-initialize-task-string-required-initialize-string-or-found-taskkey-string-required-initialize-string">Type error, found: <tt class="docutils literal"><span class="pre">Initialize[Task[String]]</span></tt>, required: <tt class="docutils literal"><span class="pre">Initialize[String]</span></tt> or found: <tt class="docutils literal"><span class="pre">TaskKey[String]</span></tt> required: <tt class="docutils literal"><span class="pre">Initialize[String]</span></tt></a></li>
<li><a class="reference internal" href="#on-project-load-reference-to-uninitialized-setting">On project load, &quot;Reference to uninitialized setting&quot;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dependency-management">Dependency Management</a><ul>
<li><a class="reference internal" href="#how-do-i-resolve-a-checksum-error">How do I resolve a checksum error?</a></li>
<li><a class="reference internal" href="#i-ve-added-a-plugin-and-now-my-cross-compilations-fail">I've added a plugin, and now my cross-compilations fail!</a></li>
<li><a class="reference internal" href="#how-do-i-use-the-scala-interpreter-in-my-code">How do I use the Scala interpreter in my code?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
                </div>
              </div></div>
        </div>
      </div>
    </div>
  </div>  
  

  </body>
</html>