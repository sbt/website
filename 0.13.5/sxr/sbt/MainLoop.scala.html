<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>sbt/MainLoop.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2008, 2009, 2010, 2011  Mark Harrah
 */</span>
<span class="keyword">package</span> sbt

	<span class="keyword">import</span> scala.annotation.tailrec
	<span class="keyword">import</span> java.io.<span class="delimiter">{</span>File, PrintWriter<span class="delimiter">}</span>
  <span class="keyword">import</span> jline.TerminalFactory

<span class="keyword">object</span> <a title="sbt.MainLoop.type" id="sbt.MainLoop">MainLoop</a>
<a href="#sbt.MainLoop" title="sbt.MainLoop.type" class="delimiter">{</a>
	<span class="comment">/** Entry point to run the remaining commands in State with managed global logging.*/</span>
	<span class="keyword">def</span> <a title="(state: sbt.State)xsbti.MainResult" id="sbt.MainLoop.runLogged">runLogged</a><span class="delimiter">(</span><a title="sbt.State" id="sbt.MainLoop.runLogged.state">state</a>: <a href="State.scala.html#sbt;State" title="sbt.State">State</a><span class="delimiter">)</span>: xsbti.<a href="../xsbti/MainResult.java.html#xsbti;MainResult" title="xsbti.MainResult">MainResult</a> = <span class="delimiter">{</span>
    <span class="comment">// We've disabled jline shutdown hooks to prevent classloader leaks, and have been careful to always restore</span>
    <span class="comment">// the jline terminal in finally blocks, but hitting ctrl+c prevents finally blocks from being executed, in that</span>
    <span class="comment">// case the only way to restore the terminal is in a shutdown hook.</span>
    <span class="keyword">val</span> <a title="Thread" id="sbt.MainLoop.runLogged.shutdownHook">shutdownHook</a> = <span title="(x$1: Runnable)Thread" class="keyword">new</span> <span title="Thread">Thread</span><span class="delimiter">(</span><a href="#sbt.MainLoop.runLogged.shutdownHook;$anon" title="Runnable" class="keyword">new</a> <a title="anonymous class $anon extends Object with Runnable" id="sbt.MainLoop.runLogged.shutdownHook;$anon">Runnable</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="()Unit" id="sbt.MainLoop.runLogged.shutdownHook;$anon.run">run</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="jline.TerminalFactory.type">TerminalFactory</span>.<span title="()jline.Terminal">get</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()Unit">restore</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>

    <span class="keyword">try</span> <span class="delimiter">{</span>
      <span title="Runtime.type">Runtime</span>.<span title="()Runtime">getRuntime</span>.<span title="(x$1: Thread)Unit">addShutdownHook</span><span class="delimiter">(</span><a href="#sbt.MainLoop.runLogged.shutdownHook" title="Thread">shutdownHook</a><span class="delimiter">)</span>
      <a href="#sbt.MainLoop.runLoggedLoop" title="(state: sbt.State, logBacking: sbt.GlobalLogBacking)xsbti.MainResult">runLoggedLoop</a><span class="delimiter">(</span><a href="#sbt.MainLoop.runLogged.state" title="sbt.State">state</a>, <a href="#sbt.MainLoop.runLogged.state" title="sbt.State">state</a>.<a href="State.scala.html#sbt;State.globalLogging" title="=&gt; sbt.GlobalLogging">globalLogging</a>.<a href="GlobalLogging.scala.html#sbt;GlobalLogging.backing" title="=&gt; sbt.GlobalLogBacking">backing</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
      <span title="Runtime.type">Runtime</span>.<span title="()Runtime">getRuntime</span>.<span title="(x$1: Thread)Boolean">removeShutdownHook</span><span title="Unit" class="delimiter">(</span><a href="#sbt.MainLoop.runLogged.shutdownHook" title="Thread">shutdownHook</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

	<span class="comment">/** Run loop that evaluates remaining commands and manages changes to global logging configuration.*/</span>
	@tailrec <span class="keyword">def</span> <a title="(state: sbt.State, logBacking: sbt.GlobalLogBacking)xsbti.MainResult" id="sbt.MainLoop.runLoggedLoop">runLoggedLoop</a><span class="delimiter">(</span><a title="sbt.State" id="sbt.MainLoop.runLoggedLoop.state">state</a>: <a href="State.scala.html#sbt;State" title="sbt.State">State</a>, <a title="sbt.GlobalLogBacking" id="sbt.MainLoop.runLoggedLoop.logBacking">logBacking</a>: <a href="GlobalLogging.scala.html#sbt;GlobalLogBacking" title="sbt.GlobalLogBacking">GlobalLogBacking</a><span class="delimiter">)</span>: xsbti.<a href="../xsbti/MainResult.java.html#xsbti;MainResult" title="xsbti.MainResult">MainResult</a> =
		<a href="#sbt.MainLoop.runAndClearLast" title="(state: sbt.State, logBacking: sbt.GlobalLogBacking)sbt.MainLoop.RunNext">runAndClearLast</a><span class="delimiter">(</span><a href="#sbt.MainLoop.runLoggedLoop.state" title="sbt.State">state</a>, <a href="#sbt.MainLoop.runLoggedLoop.logBacking" title="sbt.GlobalLogBacking">logBacking</a><span class="delimiter">)</span> <span title="xsbti.MainResult" class="keyword">match</span> <span class="delimiter">{</span>
			<span class="keyword">case</span> <a title="sbt.MainLoop.Return" id="sbt.MainLoop.runLoggedLoop.ret">ret</a>: <a href="#sbt.MainLoop;Return" title="sbt.MainLoop.Return">Return</a> =&gt;  <span class="comment">// delete current and last log files when exiting normally</span>
				<a href="#sbt.MainLoop.runLoggedLoop.logBacking" title="sbt.GlobalLogBacking">logBacking</a>.<a href="GlobalLogging.scala.html#sbt;GlobalLogBacking.file" title="=&gt; java.io.File">file</a>.<span title="()Boolean">delete</span><span class="delimiter">(</span><span class="delimiter">)</span>
				<a href="#sbt.MainLoop.deleteLastLog" title="(logBacking: sbt.GlobalLogBacking)Unit">deleteLastLog</a><span class="delimiter">(</span><a href="#sbt.MainLoop.runLoggedLoop.logBacking" title="sbt.GlobalLogBacking">logBacking</a><span class="delimiter">)</span> 
				<a href="#sbt.MainLoop.runLoggedLoop.ret" title="sbt.MainLoop.Return">ret</a>.<a href="#sbt.MainLoop;Return.result" title="=&gt; xsbti.MainResult">result</a>
			<span class="keyword">case</span> <a title="sbt.MainLoop.ClearGlobalLog" id="sbt.MainLoop.runLoggedLoop.clear">clear</a>: <a href="#sbt.MainLoop;ClearGlobalLog" title="sbt.MainLoop.ClearGlobalLog">ClearGlobalLog</a> =&gt; <span class="comment">// delete previous log file, move current to previous, and start writing to a new file</span>
				<a href="#sbt.MainLoop.deleteLastLog" title="(logBacking: sbt.GlobalLogBacking)Unit">deleteLastLog</a><span class="delimiter">(</span><a href="#sbt.MainLoop.runLoggedLoop.logBacking" title="sbt.GlobalLogBacking">logBacking</a><span class="delimiter">)</span>
				<a href="#sbt.MainLoop.runLoggedLoop" title="(state: sbt.State, logBacking: sbt.GlobalLogBacking)xsbti.MainResult">runLoggedLoop</a><span class="delimiter">(</span><a href="#sbt.MainLoop.runLoggedLoop.clear" title="sbt.MainLoop.ClearGlobalLog">clear</a>.<a href="#sbt.MainLoop;ClearGlobalLog.state" title="=&gt; sbt.State">state</a>, <a href="#sbt.MainLoop.runLoggedLoop.logBacking" title="sbt.GlobalLogBacking">logBacking</a>.<a href="GlobalLogging.scala.html#sbt;GlobalLogBacking.shiftNew" title="()sbt.GlobalLogBacking">shiftNew</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
			<span class="keyword">case</span> <a title="sbt.MainLoop.KeepGlobalLog" id="sbt.MainLoop.runLoggedLoop.keep">keep</a>: <a href="#sbt.MainLoop;KeepGlobalLog" title="sbt.MainLoop.KeepGlobalLog">KeepGlobalLog</a> =&gt; <span class="comment">// make previous log file the current log file</span>
				<a href="#sbt.MainLoop.runLoggedLoop.logBacking" title="sbt.GlobalLogBacking">logBacking</a>.<a href="GlobalLogging.scala.html#sbt;GlobalLogBacking.file" title="=&gt; java.io.File">file</a>.<span title="()Boolean">delete</span>
				<a href="#sbt.MainLoop.runLoggedLoop" title="(state: sbt.State, logBacking: sbt.GlobalLogBacking)xsbti.MainResult">runLoggedLoop</a><span class="delimiter">(</span><a href="#sbt.MainLoop.runLoggedLoop.keep" title="sbt.MainLoop.KeepGlobalLog">keep</a>.<a href="#sbt.MainLoop;KeepGlobalLog.state" title="=&gt; sbt.State">state</a>, <a href="#sbt.MainLoop.runLoggedLoop.logBacking" title="sbt.GlobalLogBacking">logBacking</a>.<a href="GlobalLogging.scala.html#sbt;GlobalLogBacking.unshift" title="=&gt; sbt.GlobalLogBacking">unshift</a><span class="delimiter">)</span>
		<span class="delimiter">}</span>
		
	<span class="comment">/** Runs the next sequence of commands, cleaning up global logging after any exceptions. */</span>
	<span class="keyword">def</span> <a title="(state: sbt.State, logBacking: sbt.GlobalLogBacking)sbt.MainLoop.RunNext" id="sbt.MainLoop.runAndClearLast">runAndClearLast</a><span class="delimiter">(</span><a title="sbt.State" id="sbt.MainLoop.runAndClearLast.state">state</a>: <a href="State.scala.html#sbt;State" title="sbt.State">State</a>, <a title="sbt.GlobalLogBacking" id="sbt.MainLoop.runAndClearLast.logBacking">logBacking</a>: <a href="GlobalLogging.scala.html#sbt;GlobalLogBacking" title="sbt.GlobalLogBacking">GlobalLogBacking</a><span class="delimiter">)</span>: <a href="#sbt.MainLoop;RunNext" title="sbt.MainLoop.RunNext">RunNext</a> =
		<span class="keyword">try</span>
			<a href="#sbt.MainLoop.runWithNewLog" title="(state: sbt.State, logBacking: sbt.GlobalLogBacking)sbt.MainLoop.RunNext">runWithNewLog</a><span class="delimiter">(</span><a href="#sbt.MainLoop.runAndClearLast.state" title="sbt.State">state</a>, <a href="#sbt.MainLoop.runAndClearLast.logBacking" title="sbt.GlobalLogBacking">logBacking</a><span class="delimiter">)</span>
		<span class="keyword">catch</span> <span class="delimiter">{</span>
			<span class="keyword">case</span> <span title="xsbti.FullReload">e</span>: xsbti.<a href="../xsbti/FullReload.java.html#xsbti;FullReload" title="xsbti.FullReload">FullReload</a> =&gt;
				<a href="#sbt.MainLoop.deleteLastLog" title="(logBacking: sbt.GlobalLogBacking)Unit">deleteLastLog</a><span class="delimiter">(</span><a href="#sbt.MainLoop.runAndClearLast.logBacking" title="sbt.GlobalLogBacking">logBacking</a><span class="delimiter">)</span>
				<span title="Nothing" class="keyword">throw</span> <span title="xsbti.FullReload">e</span> <span class="comment">// pass along a reboot request</span>
			<span class="keyword">case</span> <span title="Throwable">e</span>: <span title="Throwable">Throwable</span> =&gt;
				<span title="System.type">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;sbt appears to be exiting abnormally.\n  The log file for this session is at &quot;)" class="string">&quot;sbt appears to be exiting abnormally.\n  The log file for this session is at &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#sbt.MainLoop.runAndClearLast.logBacking" title="sbt.GlobalLogBacking">logBacking</a>.<a href="GlobalLogging.scala.html#sbt;GlobalLogBacking.file" title="=&gt; java.io.File">file</a><span class="delimiter">)</span>
				<a href="#sbt.MainLoop.deleteLastLog" title="(logBacking: sbt.GlobalLogBacking)Unit">deleteLastLog</a><span class="delimiter">(</span><a href="#sbt.MainLoop.runAndClearLast.logBacking" title="sbt.GlobalLogBacking">logBacking</a><span class="delimiter">)</span>
				<span title="Nothing" class="keyword">throw</span> <span title="Throwable">e</span>
		<span class="delimiter">}</span>

	<span class="comment">/** Deletes the previous global log file. */</span>
	<span class="keyword">def</span> <a title="(logBacking: sbt.GlobalLogBacking)Unit" id="sbt.MainLoop.deleteLastLog">deleteLastLog</a><span class="delimiter">(</span><a title="sbt.GlobalLogBacking" id="sbt.MainLoop.deleteLastLog.logBacking">logBacking</a>: <a href="GlobalLogging.scala.html#sbt;GlobalLogBacking" title="sbt.GlobalLogBacking">GlobalLogBacking</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
		<a href="#sbt.MainLoop.deleteLastLog.logBacking" title="sbt.GlobalLogBacking">logBacking</a>.<a href="GlobalLogging.scala.html#sbt;GlobalLogBacking.last" title="=&gt; Option[java.io.File]">last</a>.<span title="(f: java.io.File =&gt; Boolean)Unit">foreach</span><span class="delimiter">(</span><a href="#sbt.MainLoop.deleteLastLog.$anonfun.x$1" title="java.io.File">_</a>.<span title="()Boolean">delete</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>

	<span class="comment">/** Runs the next sequence of commands with global logging in place. */</span>
	<span class="keyword">def</span> <a title="(state: sbt.State, logBacking: sbt.GlobalLogBacking)sbt.MainLoop.RunNext" id="sbt.MainLoop.runWithNewLog">runWithNewLog</a><span class="delimiter">(</span><a title="sbt.State" id="sbt.MainLoop.runWithNewLog.state">state</a>: <a href="State.scala.html#sbt;State" title="sbt.State">State</a>, <a title="sbt.GlobalLogBacking" id="sbt.MainLoop.runWithNewLog.logBacking">logBacking</a>: <a href="GlobalLogging.scala.html#sbt;GlobalLogBacking" title="sbt.GlobalLogBacking">GlobalLogBacking</a><span class="delimiter">)</span>: <a href="#sbt.MainLoop;RunNext" title="sbt.MainLoop.RunNext">RunNext</a> =
		<a href="Using.scala.html#sbt.Using" title="sbt.Using.type">Using</a>.<a href="Using.scala.html#sbt.Using.fileWriter$default$1" title="java.nio.charset.Charset" id="sbt.MainLoop.runWithNewLog.x$3">fileWriter</a><a href="Using.scala.html#sbt;Using.apply" title="(src: java.io.File)(f: java.io.BufferedWriter =&gt; sbt.MainLoop.RunNext)sbt.MainLoop.RunNext" class="delimiter">(</a>append = <a title="Boolean" id="sbt.MainLoop.runWithNewLog.x$2" class="keyword">true</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#sbt.MainLoop.runWithNewLog.logBacking" title="sbt.GlobalLogBacking">logBacking</a>.<a href="GlobalLogging.scala.html#sbt;GlobalLogBacking.file" title="=&gt; java.io.File">file</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a title="java.io.BufferedWriter" id="sbt.MainLoop.runWithNewLog.$anonfun.writer">writer</a> =&gt;
			<span class="keyword">val</span> <a title="java.io.PrintWriter" id="sbt.MainLoop.runWithNewLog.$anonfun.out">out</a> = <span title="java.io.PrintWriter" class="keyword">new</span> java.io.<span title="java.io.PrintWriter">PrintWriter</span><span class="delimiter">(</span><a href="#sbt.MainLoop.runWithNewLog.$anonfun.writer" title="java.io.BufferedWriter">writer</a><span class="delimiter">)</span>
			<span class="keyword">val</span> <a title="sbt.GlobalLogging" id="sbt.MainLoop.runWithNewLog.$anonfun.newLogging">newLogging</a> = <a href="#sbt.MainLoop.runWithNewLog.state" title="sbt.State">state</a>.<a href="State.scala.html#sbt;State.globalLogging" title="=&gt; sbt.GlobalLogging">globalLogging</a>.<a href="GlobalLogging.scala.html#sbt;GlobalLogging.newLogger" title="(v1: java.io.PrintWriter, v2: sbt.GlobalLogBacking)sbt.GlobalLogging">newLogger</a><span class="delimiter">(</span><a href="#sbt.MainLoop.runWithNewLog.$anonfun.out" title="java.io.PrintWriter">out</a>, <a href="#sbt.MainLoop.runWithNewLog.logBacking" title="sbt.GlobalLogBacking">logBacking</a><span class="delimiter">)</span>
			<a href="#sbt.MainLoop.transferLevels" title="(state: sbt.State, logging: sbt.GlobalLogging)Unit">transferLevels</a><span class="delimiter">(</span><a href="#sbt.MainLoop.runWithNewLog.state" title="sbt.State">state</a>, <a href="#sbt.MainLoop.runWithNewLog.$anonfun.newLogging" title="sbt.GlobalLogging">newLogging</a><span class="delimiter">)</span>
			<span class="keyword">val</span> <a title="sbt.State" id="sbt.MainLoop.runWithNewLog.$anonfun.loggedState">loggedState</a> = <a href="#sbt.MainLoop.runWithNewLog.state" title="sbt.State">state</a>.<a href="State.scala.html#sbt;State.copy$default$1" title="xsbti.AppConfiguration" id="sbt.MainLoop.runWithNewLog.$anonfun.loggedState.x$12">copy</a><span class="delimiter">(</span>globalLogging = <a href="#sbt.MainLoop.runWithNewLog.$anonfun.newLogging" title="sbt.GlobalLogging" id="sbt.MainLoop.runWithNewLog.$anonfun.loggedState.x$4">newLogging</a><span class="delimiter">)</span>
			<span class="keyword">try</span> <a href="#sbt.MainLoop.run" title="(state: sbt.State)sbt.MainLoop.RunNext">run</a><span class="delimiter">(</span><a href="#sbt.MainLoop.runWithNewLog.$anonfun.loggedState" title="sbt.State">loggedState</a><span class="delimiter">)</span> <span class="keyword">finally</span> <a href="#sbt.MainLoop.runWithNewLog.$anonfun.out" title="java.io.PrintWriter">out</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
		<span class="delimiter">}</span>

	<span class="comment">/** Transfers logging and trace levels from the old global loggers to the new ones. */</span>
	<span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="(state: sbt.State, logging: sbt.GlobalLogging)Unit" id="sbt.MainLoop.transferLevels">transferLevels</a><span class="delimiter">(</span><a title="sbt.State" id="sbt.MainLoop.transferLevels.state">state</a>: <a href="State.scala.html#sbt;State" title="sbt.State">State</a>, <a title="sbt.GlobalLogging" id="sbt.MainLoop.transferLevels.logging">logging</a>: <a href="GlobalLogging.scala.html#sbt;GlobalLogging" title="sbt.GlobalLogging">GlobalLogging</a><span class="delimiter">)</span> <span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="sbt.GlobalLogging" id="sbt.MainLoop.transferLevels.old">old</a> = <a href="#sbt.MainLoop.transferLevels.state" title="sbt.State">state</a>.<a href="State.scala.html#sbt;State.globalLogging" title="=&gt; sbt.GlobalLogging">globalLogging</a>
		<a href="Logger.scala.html#sbt.Logger" title="sbt.Logger.type">Logger</a>.<a href="Logger.scala.html#sbt.Logger.transferLevels" title="(oldLog: sbt.AbstractLogger, newLog: sbt.AbstractLogger)Unit">transferLevels</a><span class="delimiter">(</span><a href="#sbt.MainLoop.transferLevels.old" title="sbt.GlobalLogging">old</a>.<a href="GlobalLogging.scala.html#sbt;GlobalLogging.backed" title="=&gt; sbt.AbstractLogger">backed</a>, <a href="#sbt.MainLoop.transferLevels.logging" title="sbt.GlobalLogging">logging</a>.<a href="GlobalLogging.scala.html#sbt;GlobalLogging.backed" title="=&gt; sbt.AbstractLogger">backed</a><span class="delimiter">)</span>
		<span title="(_1: sbt.Logger, _2: sbt.Logger)(sbt.Logger, sbt.Logger)" class="delimiter">(</span><a href="#sbt.MainLoop.transferLevels.old" title="sbt.GlobalLogging">old</a>.<a href="GlobalLogging.scala.html#sbt;GlobalLogging.full" title="=&gt; sbt.Logger">full</a>, <a href="#sbt.MainLoop.transferLevels.logging" title="sbt.GlobalLogging">logging</a>.<a href="GlobalLogging.scala.html#sbt;GlobalLogging.full" title="=&gt; sbt.Logger">full</a><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span> <span class="comment">// well, this is a hack</span>
			<span class="keyword">case</span> <span class="delimiter">(</span><a title="sbt.AbstractLogger" id="sbt.MainLoop.transferLevels.oldLog">oldLog</a>: <a href="Logger.scala.html#sbt;AbstractLogger" title="sbt.AbstractLogger">AbstractLogger</a>, <a title="sbt.AbstractLogger" id="sbt.MainLoop.transferLevels.newLog">newLog</a>: <a href="Logger.scala.html#sbt;AbstractLogger" title="sbt.AbstractLogger">AbstractLogger</a><span class="delimiter">)</span> =&gt; <a href="Logger.scala.html#sbt.Logger" title="sbt.Logger.type">Logger</a>.<a href="Logger.scala.html#sbt.Logger.transferLevels" title="(oldLog: sbt.AbstractLogger, newLog: sbt.AbstractLogger)Unit">transferLevels</a><span class="delimiter">(</span><a href="#sbt.MainLoop.transferLevels.oldLog" title="sbt.AbstractLogger">oldLog</a>, <a href="#sbt.MainLoop.transferLevels.newLog" title="sbt.AbstractLogger">newLog</a><span class="delimiter">)</span>
			<span class="keyword">case</span> _ =&gt; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
		<span class="delimiter">}</span>
	<span class="delimiter">}</span>

	<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait RunNext extends AnyRef" id="sbt.MainLoop;RunNext">RunNext</a>
	<span class="keyword">final</span> <span class="keyword">class</span> <a title="class ClearGlobalLog extends AnyRef with sbt.MainLoop.RunNext" id="sbt.MainLoop;ClearGlobalLog">ClearGlobalLog</a><a href="#sbt.MainLoop;ClearGlobalLog" title="sbt.MainLoop.ClearGlobalLog" class="delimiter">(</a><span class="keyword">val</span> <a title="sbt.State" id="sbt.MainLoop;ClearGlobalLog.state">state</a>: <a href="State.scala.html#sbt;State" title="sbt.State">State</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#sbt.MainLoop;RunNext" title="sbt.MainLoop.RunNext">RunNext</a>
	<span class="keyword">final</span> <span class="keyword">class</span> <a title="class KeepGlobalLog extends AnyRef with sbt.MainLoop.RunNext" id="sbt.MainLoop;KeepGlobalLog">KeepGlobalLog</a><a href="#sbt.MainLoop;KeepGlobalLog" title="sbt.MainLoop.KeepGlobalLog" class="delimiter">(</a><span class="keyword">val</span> <a title="sbt.State" id="sbt.MainLoop;KeepGlobalLog.state">state</a>: <a href="State.scala.html#sbt;State" title="sbt.State">State</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#sbt.MainLoop;RunNext" title="sbt.MainLoop.RunNext">RunNext</a>
	<span class="keyword">final</span> <span class="keyword">class</span> <a title="class Return extends AnyRef with sbt.MainLoop.RunNext" id="sbt.MainLoop;Return">Return</a><a href="#sbt.MainLoop;Return" title="sbt.MainLoop.Return" class="delimiter">(</a><span class="keyword">val</span> <a title="xsbti.MainResult" id="sbt.MainLoop;Return.result">result</a>: xsbti.<a href="../xsbti/MainResult.java.html#xsbti;MainResult" title="xsbti.MainResult">MainResult</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#sbt.MainLoop;RunNext" title="sbt.MainLoop.RunNext">RunNext</a>

	<span class="comment">/** Runs the next sequence of commands that doesn't require global logging changes.*/</span>
	@tailrec <span class="keyword">def</span> <a title="(state: sbt.State)sbt.MainLoop.RunNext" id="sbt.MainLoop.run">run</a><span class="delimiter">(</span><a title="sbt.State" id="sbt.MainLoop.run.state">state</a>: <a href="State.scala.html#sbt;State" title="sbt.State">State</a><span class="delimiter">)</span>: <a href="#sbt.MainLoop;RunNext" title="sbt.MainLoop.RunNext">RunNext</a> =
		<a href="#sbt.MainLoop.run.state" title="sbt.State">state</a>.<a href="State.scala.html#sbt;State.next" title="=&gt; sbt.State.Next">next</a> <span title="sbt.MainLoop.RunNext" class="keyword">match</span>
		<span class="delimiter">{</span>
			<span class="keyword">case</span> <a href="State.scala.html#sbt.State" title="sbt.State.type">State</a>.<a href="State.scala.html#sbt.State.Continue" title="sbt.State.Continue.type">Continue</a> =&gt; <a href="#sbt.MainLoop.run" title="(state: sbt.State)sbt.MainLoop.RunNext">run</a><span class="delimiter">(</span><a href="#sbt.MainLoop.next" title="(state: sbt.State)sbt.State">next</a><span class="delimiter">(</span><a href="#sbt.MainLoop.run.state" title="sbt.State">state</a><span class="delimiter">)</span><span class="delimiter">)</span>
			<span class="keyword">case</span> <a href="State.scala.html#sbt.State" title="sbt.State.type">State</a>.<a href="State.scala.html#sbt.State.ClearGlobalLog" title="sbt.State.ClearGlobalLog.type">ClearGlobalLog</a> =&gt; <span title="sbt.MainLoop.ClearGlobalLog" class="keyword">new</span> <a href="#sbt.MainLoop;ClearGlobalLog" title="sbt.MainLoop.ClearGlobalLog">ClearGlobalLog</a><span class="delimiter">(</span><a href="State.scala.html#sbt.State.stateOps" title="implicit sbt.State.stateOps : (s: sbt.State)sbt.StateOps">state</a>.<a href="State.scala.html#sbt;StateOps.continue" title="=&gt; sbt.State">continue</a><span class="delimiter">)</span>
			<span class="keyword">case</span> <a href="State.scala.html#sbt.State" title="sbt.State.type">State</a>.<a href="State.scala.html#sbt.State.KeepLastLog" title="sbt.State.KeepLastLog.type">KeepLastLog</a> =&gt; <span title="sbt.MainLoop.KeepGlobalLog" class="keyword">new</span> <a href="#sbt.MainLoop;KeepGlobalLog" title="sbt.MainLoop.KeepGlobalLog">KeepGlobalLog</a><span class="delimiter">(</span><a href="State.scala.html#sbt.State.stateOps" title="implicit sbt.State.stateOps : (s: sbt.State)sbt.StateOps">state</a>.<a href="State.scala.html#sbt;StateOps.continue" title="=&gt; sbt.State">continue</a><span class="delimiter">)</span>
			<span class="keyword">case</span> <a title="sbt.State.Return" id="sbt.MainLoop.run.ret">ret</a>: State.<a href="State.scala.html#sbt.State;Return" title="sbt.State.Return">Return</a> =&gt; <span title="sbt.MainLoop.Return" class="keyword">new</span> <a href="#sbt.MainLoop;Return" title="sbt.MainLoop.Return">Return</a><span class="delimiter">(</span><a href="#sbt.MainLoop.run.ret" title="sbt.State.Return">ret</a>.<a href="State.scala.html#sbt.State;Return.result" title="=&gt; xsbti.MainResult">result</a><span class="delimiter">)</span>
		<span class="delimiter">}</span>

	<span class="keyword">def</span> <a title="(state: sbt.State)sbt.State" id="sbt.MainLoop.next">next</a><span class="delimiter">(</span><a title="sbt.State" id="sbt.MainLoop.next.state">state</a>: <a href="State.scala.html#sbt;State" title="sbt.State">State</a><span class="delimiter">)</span>: <a href="State.scala.html#sbt;State" title="sbt.State">State</a> =
		<a href="ErrorHandling.scala.html#sbt.ErrorHandling" title="sbt.ErrorHandling.type">ErrorHandling</a>.<a href="ErrorHandling.scala.html#sbt.ErrorHandling.wideConvert" title="(f: =&gt; sbt.State)Either[Throwable,sbt.State]">wideConvert</a> <span class="delimiter">{</span> <a href="State.scala.html#sbt.State.stateOps" title="implicit sbt.State.stateOps : (s: sbt.State)sbt.StateOps">state</a>.<a href="State.scala.html#sbt;StateOps.process" title="(f: (String, sbt.State) =&gt; sbt.State)sbt.State">process</a><span class="delimiter">(</span><a href="Command.scala.html#sbt.Command" title="sbt.Command.type">Command</a>.<a href="Command.scala.html#sbt.Command.process" title="(command: String, state: sbt.State)sbt.State">process</a><span class="delimiter">)</span> <span class="delimiter">}</span> <span title="sbt.State" class="keyword">match</span>
		<span class="delimiter">{</span>
			<span class="keyword">case</span> Right<span class="delimiter">(</span><a title="sbt.State" id="sbt.MainLoop.next.s">s</a><span class="delimiter">)</span> =&gt; <a href="#sbt.MainLoop.next.s" title="sbt.State">s</a>
			<span class="keyword">case</span> Left<span class="delimiter">(</span><span title="xsbti.FullReload">t</span>: xsbti.<a href="../xsbti/FullReload.java.html#xsbti;FullReload" title="xsbti.FullReload">FullReload</a><span class="delimiter">)</span> =&gt; <span title="Nothing" class="keyword">throw</span> <span title="xsbti.FullReload">t</span>
			<span class="keyword">case</span> Left<span class="delimiter">(</span><span title="Throwable">t</span><span class="delimiter">)</span> =&gt; <a href="#sbt.MainLoop.handleException(21c4fea0e1)" title="(e: Throwable, s: sbt.State)sbt.State">handleException</a><span class="delimiter">(</span><span title="Throwable">t</span>, <a href="#sbt.MainLoop.next.state" title="sbt.State">state</a><span class="delimiter">)</span>
		<span class="delimiter">}</span>

	@deprecated<span class="delimiter">(</span><span class="string">&quot;Use State.handleError&quot;</span>, <span class="string">&quot;0.13.0&quot;</span><span class="delimiter">)</span>
	<span class="keyword">def</span> <a title="(e: Throwable, s: sbt.State)sbt.State" id="sbt.MainLoop.handleException(21c4fea0e1)">handleException</a><span class="delimiter">(</span><a title="Throwable" id="sbt.MainLoop.handleException(21c4fea0e1).e">e</a>: <span title="Throwable">Throwable</span>, <a title="sbt.State" id="sbt.MainLoop.handleException(21c4fea0e1).s">s</a>: <a href="State.scala.html#sbt;State" title="sbt.State">State</a><span class="delimiter">)</span>: <a href="State.scala.html#sbt;State" title="sbt.State">State</a> = <a href="State.scala.html#sbt.State.stateOps" title="implicit sbt.State.stateOps : (s: sbt.State)sbt.StateOps">s</a>.<a href="State.scala.html#sbt;StateOps.handleError" title="(t: Throwable)sbt.State">handleError</a><span class="delimiter">(</span><a href="#sbt.MainLoop.handleException(21c4fea0e1).e" title="Throwable">e</a><span class="delimiter">)</span>

	@deprecated<span class="delimiter">(</span><span class="string">&quot;Use State.handleError&quot;</span>, <span class="string">&quot;0.13.0&quot;</span><span class="delimiter">)</span>
	<span class="keyword">def</span> <a title="(t: Throwable, s: sbt.State, log: sbt.Logger)sbt.State" id="sbt.MainLoop.handleException(4f3a7106f3)">handleException</a><span class="delimiter">(</span><a title="Throwable" id="sbt.MainLoop.handleException(4f3a7106f3).t">t</a>: <span title="Throwable">Throwable</span>, <a title="sbt.State" id="sbt.MainLoop.handleException(4f3a7106f3).s">s</a>: <a href="State.scala.html#sbt;State" title="sbt.State">State</a>, <a title="sbt.Logger" id="sbt.MainLoop.handleException(4f3a7106f3).log">log</a>: <a href="Logger.scala.html#sbt;Logger" title="sbt.Logger">Logger</a><span class="delimiter">)</span>: <a href="State.scala.html#sbt;State" title="sbt.State">State</a> = <a href="State.scala.html#sbt.State" title="sbt.State.type">State</a>.<a href="State.scala.html#sbt.State.handleException" title="(t: Throwable, s: sbt.State, log: sbt.Logger)sbt.State">handleException</a><span class="delimiter">(</span><a href="#sbt.MainLoop.handleException(4f3a7106f3).t" title="Throwable">t</a>, <a href="#sbt.MainLoop.handleException(4f3a7106f3).s" title="sbt.State">s</a>, <a href="#sbt.MainLoop.handleException(4f3a7106f3).log" title="sbt.Logger">log</a><span class="delimiter">)</span>

	<span class="keyword">def</span> <a title="(e: Throwable, log: sbt.Logger)Unit" id="sbt.MainLoop.logFullException">logFullException</a><span class="delimiter">(</span><a title="Throwable" id="sbt.MainLoop.logFullException.e">e</a>: <span title="Throwable">Throwable</span>, <a title="sbt.Logger" id="sbt.MainLoop.logFullException.log">log</a>: <a href="Logger.scala.html#sbt;Logger" title="sbt.Logger">Logger</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="State.scala.html#sbt.State" title="sbt.State.type">State</a>.<a href="State.scala.html#sbt.State.logFullException" title="(e: Throwable, log: sbt.Logger)Unit">logFullException</a><span class="delimiter">(</span><a href="#sbt.MainLoop.logFullException.e" title="Throwable">e</a>, <a href="#sbt.MainLoop.logFullException.log" title="sbt.Logger">log</a><span class="delimiter">)</span>
<span class="delimiter">}</span>
        </pre>
    </body>
</html>
