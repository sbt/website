


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Artifacts &mdash; sbt Documentation</title>
    
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/issuetracker.css" type="text/css" />
    <link rel="stylesheet" href="../_static/base.css" type="text/css" />
    <link rel="stylesheet" href="../_static/docs.css" type="text/css" />
    <link rel="stylesheet" href="../_static/syntax.css" type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Exo:300,400,600,700" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.12.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../versions.js"></script>
    <script type="text/javascript" src="../_static/set-versions.js"></script>
    <link rel="top" title="sbt Documentation" href="../index.html" />
    <link rel="up" title="Detailed Topics" href="index.html" />
    <link rel="next" title="Best Practices" href="Best-Practices.html" />
    <link rel="prev" title="Detailed Topics" href="index.html" /> 
  </head>
  <body>
  <div class="navbar">
    <div class="navbar-inner">
      <div class="container">
        <ul class="nav">
          <li><a href="http://www.scala-sbt.org/">Home</a></li>
          <li><a href="../index.html">Documentation</a></li>
          <li><a href="../Getting-Started/Setup.html">Download</a></li>
          <li><a href="http://groups.google.com/group/simple-build-tool">Mailing List</a></li>
          <li><a href="http://github.com/harrah/xsbt">Project</a></li>           
        </ul>
      </div>
    </div>
  </div>
  <div class="main">
    <div class="container">
      <div class="page-title">Artifacts</div>
      <div class="search-box">
        <form method="get" action="http://www.google.com/search" id="search">
          <input type="search" placeholder="Search 0.12.1 on Google" name="q" results="10" size="29" id="search-input">
          <input type="hidden"  name="sitesearch" value="http://www.scala-sbt.org/release/docs/"> 
          <input type="submit" id="submit-search">
        </form>
      </div>
    </div>
    <div class="main-container">
      <div class="container">
        <div class="row">
          <div class="span12">
            <ul class="breadcrumb">        
              <li>
                 <span class="divider">|</span> <a href="Best-Practices.html">Best Practices</a> <span class="divider">»</span>
              </li>
              <li>
                 <span class="divider">&gt;</span><a href="index.html">Detailed Topics</a>
              </li>
              <li>
                <a href="../index.html">Contents</a>
              </li>
              <li>
                <span class="divider">«</span> <a href="index.html">Detailed Topics</a> <span class="divider">|</span>
              </li>
              <li>
                <select id="versions"><option selected value="0.12.1">Version 0.12.1</option></select>
              </li>
            </ul>         
          </div>
        </div>
        <div class="row">
          <div class="span9">
            
  <div class="section" id="artifacts">
<h1>Artifacts<a class="headerlink" href="#artifacts" title="Permalink to this headline">¶</a></h1>
<div class="section" id="selecting-default-artifacts">
<h2>Selecting default artifacts<a class="headerlink" href="#selecting-default-artifacts" title="Permalink to this headline">¶</a></h2>
<p>By default, the published artifacts are the main binary jar, a jar
containing the main sources and resources, and a jar containing the API
documentation. You can add artifacts for the test classes, sources, or
API or you can disable some of the main artifacts.</p>
<p>To add all test artifacts:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">publishArtifact</span> <span class="n">in</span> <span class="nc">Test</span> <span class="o">:=</span> <span class="kc">true</span>
</pre></div>
</div>
<p>To add them individually:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// enable publishing the jar produced by `test:package`</span>
<span class="n">publishArtifact</span> <span class="n">in</span> <span class="o">(</span><span class="nc">Test</span><span class="o">,</span> <span class="n">packageBin</span><span class="o">)</span> <span class="o">:=</span> <span class="kc">true</span>

<span class="c1">// enable publishing the test API jar</span>
<span class="n">publishArtifact</span> <span class="n">in</span> <span class="o">(</span><span class="nc">Test</span><span class="o">,</span> <span class="n">packageDoc</span><span class="o">)</span> <span class="o">:=</span> <span class="kc">true</span>

<span class="c1">// enable publishing the test sources jar</span>
<span class="n">publishArtifact</span> <span class="n">in</span> <span class="o">(</span><span class="nc">Test</span><span class="o">,</span> <span class="n">packageSrc</span><span class="o">)</span> <span class="o">:=</span> <span class="kc">true</span>
</pre></div>
</div>
<p>To disable main artifacts individually:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// disable publishing the main jar produced by `package`</span>
<span class="n">publishArtifact</span> <span class="n">in</span> <span class="o">(</span><span class="nc">Compile</span><span class="o">,</span> <span class="n">packageBin</span><span class="o">)</span> <span class="o">:=</span> <span class="kc">false</span>

<span class="c1">// disable publishing the main API jar</span>
<span class="n">publishArtifact</span> <span class="n">in</span> <span class="o">(</span><span class="nc">Compile</span><span class="o">,</span> <span class="n">packageDoc</span><span class="o">)</span> <span class="o">:=</span> <span class="kc">false</span>

<span class="c1">// disable publishing the main sources jar</span>
<span class="n">publishArtifact</span> <span class="n">in</span> <span class="o">(</span><span class="nc">Compile</span><span class="o">,</span> <span class="n">packageSrc</span><span class="o">)</span> <span class="o">:=</span> <span class="kc">false</span>
</pre></div>
</div>
</div>
<div class="section" id="modifying-default-artifacts">
<h2>Modifying default artifacts<a class="headerlink" href="#modifying-default-artifacts" title="Permalink to this headline">¶</a></h2>
<p>Each built-in artifact has several configurable settings in addition to
<tt class="docutils literal"><span class="pre">publish-artifact</span></tt>. The basic ones are <tt class="docutils literal"><span class="pre">artifact</span></tt> (of type
<tt class="docutils literal"><span class="pre">SettingKey[Artifact]</span></tt>), <tt class="docutils literal"><span class="pre">mappings</span></tt> (of type
<tt class="docutils literal"><span class="pre">TaskKey[(File,String)]</span></tt>), and <tt class="docutils literal"><span class="pre">artifactPath</span></tt> (of type
<tt class="docutils literal"><span class="pre">SettingKey[File]</span></tt>). They are scoped by <tt class="docutils literal"><span class="pre">(&lt;config&gt;,</span> <span class="pre">&lt;task&gt;)</span></tt> as
indicated in the previous section.</p>
<p>To modify the type of the main artifact, for example:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">artifact</span> <span class="n">in</span> <span class="o">(</span><span class="nc">Compile</span><span class="o">,</span> <span class="n">packageBin</span><span class="o">)</span> <span class="o">~=</span> <span class="o">{</span> <span class="o">(</span><span class="n">art</span><span class="k">:</span> <span class="kt">Artifact</span><span class="o">)</span> <span class="k">=&gt;</span>
  <span class="n">art</span><span class="o">.</span><span class="n">copy</span><span class="o">(</span><span class="n">`type`</span> <span class="k">=</span> <span class="s">&quot;bundle&quot;</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The generated artifact name is determined by the <tt class="docutils literal"><span class="pre">artifact-name</span></tt>
setting. This setting is of type
<tt class="docutils literal"><span class="pre">(ScalaVersion,</span> <span class="pre">ModuleID,</span> <span class="pre">Artifact)</span> <span class="pre">=&gt;</span> <span class="pre">String</span></tt>. The ScalaVersion
argument provides the full Scala version String and the binary
compatible part of the version String. The String result is the name of
the file to produce. The default implementation is
<tt class="docutils literal"><span class="pre">Artifact.artifactName</span> <span class="pre">_</span></tt>. The function may be modified to produce
different local names for artifacts without affecting the published
name, which is determined by the <tt class="docutils literal"><span class="pre">artifact</span></tt> definition combined with
the repository pattern.</p>
<p>For example, to produce a minimal name without a classifier or cross
path:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">artifactName</span> <span class="o">:=</span> <span class="o">{</span> <span class="o">(</span><span class="n">sv</span><span class="k">:</span> <span class="kt">ScalaVersion</span><span class="o">,</span> <span class="n">module</span><span class="k">:</span> <span class="kt">ModuleID</span><span class="o">,</span> <span class="n">artifact</span><span class="k">:</span> <span class="kt">Artifact</span><span class="o">)</span> <span class="k">=&gt;</span>
  <span class="n">artifact</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot;-&quot;</span> <span class="o">+</span> <span class="n">module</span><span class="o">.</span><span class="n">revision</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span> <span class="o">+</span> <span class="n">artifact</span><span class="o">.</span><span class="n">extension</span>
<span class="o">}</span>
</pre></div>
</div>
<p>(Note that in practice you rarely want to drop the classifier.)</p>
<p>Finally, you can get the <tt class="docutils literal"><span class="pre">(Artifact,</span> <span class="pre">File)</span></tt> pair for the artifact by
mapping the <tt class="docutils literal"><span class="pre">packaged-artifact</span></tt> task. Note that if you don't need the
<tt class="docutils literal"><span class="pre">Artifact</span></tt>, you can get just the File from the package task
(<tt class="docutils literal"><span class="pre">package</span></tt>, <tt class="docutils literal"><span class="pre">package-doc</span></tt>, or <tt class="docutils literal"><span class="pre">package-src</span></tt>). In both cases,
mapping the task to get the file ensures that the artifact is generated
first and so the file is guaranteed to be up-to-date.</p>
<p>For example:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">myTask</span> <span class="o">&lt;&lt;=</span> <span class="n">packagedArtifact</span> <span class="n">in</span> <span class="o">(</span><span class="nc">Compile</span><span class="o">,</span> <span class="n">packageBin</span><span class="o">)</span> <span class="n">map</span> <span class="o">{</span> <span class="k">case</span> <span class="o">(</span><span class="n">art</span><span class="k">:</span> <span class="kt">Artifact</span><span class="o">,</span> <span class="n">file</span><span class="k">:</span> <span class="kt">File</span><span class="o">)</span> <span class="k">=&gt;</span>
  <span class="n">println</span><span class="o">(</span><span class="s">&quot;Artifact definition: &quot;</span> <span class="o">+</span> <span class="n">art</span><span class="o">)</span>
  <span class="n">println</span><span class="o">(</span><span class="s">&quot;Packaged file: &quot;</span> <span class="o">+</span> <span class="n">file</span><span class="o">.</span><span class="n">getAbsolutePath</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">val</span> <span class="pre">myTask</span> <span class="pre">=</span> <span class="pre">TaskKey[Unit]</span></tt>.</p>
</div>
<div class="section" id="defining-custom-artifacts">
<h2>Defining custom artifacts<a class="headerlink" href="#defining-custom-artifacts" title="Permalink to this headline">¶</a></h2>
<p>In addition to configuring the built-in artifacts, you can declare other
artifacts to publish. Multiple artifacts are allowed when using Ivy
metadata, but a Maven POM file only supports distinguishing artifacts
based on classifiers and these are not recorded in the POM.</p>
<p>Basic <tt class="docutils literal"><span class="pre">Artifact</span></tt> construction look like:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="nc">Artifact</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="s">&quot;type&quot;</span><span class="o">,</span> <span class="s">&quot;extension&quot;</span><span class="o">)</span>
<span class="nc">Artifact</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="s">&quot;classifier&quot;</span><span class="o">)</span>
<span class="nc">Artifact</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="n">url</span><span class="k">:</span> <span class="kt">URL</span><span class="o">)</span>
<span class="nc">Artifact</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="nc">Map</span><span class="o">(</span><span class="s">&quot;extra1&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;value1&quot;</span><span class="o">,</span> <span class="s">&quot;extra2&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;value2&quot;</span><span class="o">))</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="nc">Artifact</span><span class="o">(</span><span class="s">&quot;myproject&quot;</span><span class="o">,</span> <span class="s">&quot;zip&quot;</span><span class="o">,</span> <span class="s">&quot;zip&quot;</span><span class="o">)</span>
<span class="nc">Artifact</span><span class="o">(</span><span class="s">&quot;myproject&quot;</span><span class="o">,</span> <span class="s">&quot;image&quot;</span><span class="o">,</span> <span class="s">&quot;jpg&quot;</span><span class="o">)</span>
<span class="nc">Artifact</span><span class="o">(</span><span class="s">&quot;myproject&quot;</span><span class="o">,</span> <span class="s">&quot;jdk15&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>See the <a class="reference external" href="http://ant.apache.org/ivy/history/2.2.0/ivyfile/dependency-artifact.html">Ivy
documentation</a>
for more details on artifacts. See the <a class="reference external" href="../../api/sbt/Artifact$.html">Artifact
API</a> for
combining the parameters above and specifying [Configurations] and extra
attributes.</p>
<p>To declare these artifacts for publishing, map them to the task that
generates the artifact:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">myImageTask</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">artifact</span><span class="k">:</span> <span class="kt">File</span> <span class="o">=</span> <span class="n">makeArtifact</span><span class="o">(...)</span>
  <span class="n">artifact</span>
<span class="o">}</span>

<span class="n">addArtifact</span><span class="o">(</span> <span class="nc">Artifact</span><span class="o">(</span><span class="s">&quot;myproject&quot;</span><span class="o">,</span> <span class="s">&quot;image&quot;</span><span class="o">,</span> <span class="s">&quot;jpg&quot;</span><span class="o">),</span> <span class="n">myImageTask</span> <span class="o">)</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">val</span> <span class="pre">myImageTask</span> <span class="pre">=</span> <span class="pre">TaskKey[File](...)</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">addArtifact</span></tt> returns a sequence of settings (wrapped in a
<a class="reference external" href="../../api/#sbt.Init$SettingsDefinition">SettingsDefinition</a>).
In a full build configuration, usage looks like:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="o">...</span>
<span class="k">lazy</span> <span class="k">val</span> <span class="n">proj</span> <span class="k">=</span> <span class="nc">Project</span><span class="o">(...)</span>
  <span class="o">.</span><span class="n">settings</span><span class="o">(</span> <span class="n">addArtifact</span><span class="o">(...).</span><span class="n">settings</span> <span class="k">:</span> <span class="k">_</span><span class="kt">*</span> <span class="o">)</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="publishing-war-files">
<h2>Publishing .war files<a class="headerlink" href="#publishing-war-files" title="Permalink to this headline">¶</a></h2>
<p>A common use case for web applications is to publish the <tt class="docutils literal"><span class="pre">.war</span></tt> file
instead of the <tt class="docutils literal"><span class="pre">.jar</span></tt> file.</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// disable .jar publishing</span>
<span class="n">publishArtifact</span> <span class="n">in</span> <span class="o">(</span><span class="nc">Compile</span><span class="o">,</span> <span class="n">packageBin</span><span class="o">)</span> <span class="o">:=</span> <span class="kc">false</span>

<span class="c1">// create an Artifact for publishing the .war file</span>
<span class="n">artifact</span> <span class="n">in</span> <span class="o">(</span><span class="nc">Compile</span><span class="o">,</span> <span class="n">packageWar</span><span class="o">)</span> <span class="o">~=</span> <span class="o">{</span> <span class="o">(</span><span class="n">art</span><span class="k">:</span> <span class="kt">Artifact</span><span class="o">)</span> <span class="k">=&gt;</span>
  <span class="n">art</span><span class="o">.</span><span class="n">copy</span><span class="o">(</span><span class="n">`type`</span> <span class="k">=</span> <span class="s">&quot;war&quot;</span><span class="o">,</span> <span class="n">extension</span> <span class="k">=</span> <span class="s">&quot;war&quot;</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1">// add the .war file to what gets published</span>
<span class="n">addArtifact</span><span class="o">(</span><span class="n">artifact</span> <span class="n">in</span> <span class="o">(</span><span class="nc">Compile</span><span class="o">,</span> <span class="n">packageWar</span><span class="o">),</span> <span class="n">packageWar</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="using-dependencies-with-artifacts">
<h2>Using dependencies with artifacts<a class="headerlink" href="#using-dependencies-with-artifacts" title="Permalink to this headline">¶</a></h2>
<p>To specify the artifacts to use from a dependency that has custom or
multiple artifacts, use the <tt class="docutils literal"><span class="pre">artifacts</span></tt> method on your dependencies.
For example:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">&quot;org&quot;</span> <span class="o">%</span> <span class="s">&quot;name&quot;</span> <span class="o">%</span> <span class="s">&quot;rev&quot;</span> <span class="n">artifacts</span><span class="o">(</span><span class="nc">Artifact</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="s">&quot;type&quot;</span><span class="o">,</span> <span class="s">&quot;ext&quot;</span><span class="o">))</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">from</span></tt> and <tt class="docutils literal"><span class="pre">classifer</span></tt> methods (described on the <a class="reference internal" href="Library-Management.html"><em>Library Management</em></a>
page) are actually convenience methods that translate to <tt class="docutils literal"><span class="pre">artifacts</span></tt>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">def</span> <span class="n">from</span><span class="o">(</span><span class="n">url</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="n">artifacts</span><span class="o">(</span> <span class="nc">Artifact</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="k">new</span> <span class="nc">URL</span><span class="o">(</span><span class="n">url</span><span class="o">))</span> <span class="o">)</span>
<span class="k">def</span> <span class="n">classifier</span><span class="o">(</span><span class="n">c</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="n">artifacts</span><span class="o">(</span> <span class="nc">Artifact</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">c</span><span class="o">)</span> <span class="o">)</span>
</pre></div>
</div>
<p>That is, the following two dependency declarations are equivalent:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">&quot;org.testng&quot;</span> <span class="o">%</span> <span class="s">&quot;testng&quot;</span> <span class="o">%</span> <span class="s">&quot;5.7&quot;</span> <span class="n">classifier</span> <span class="s">&quot;jdk15&quot;</span>

<span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">&quot;org.testng&quot;</span> <span class="o">%</span> <span class="s">&quot;testng&quot;</span> <span class="o">%</span> <span class="s">&quot;5.7&quot;</span> <span class="n">artifacts</span><span class="o">(</span><span class="nc">Artifact</span><span class="o">(</span><span class="s">&quot;testng&quot;</span><span class="o">,</span> <span class="s">&quot;jdk15&quot;</span><span class="o">)</span> <span class="o">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <div class="span3"><p class="contents-title">Contents</p>
              <div id="scroller-anchor">
                <div id="scroller">
                  <div id="toc"><ul>
<li><a class="reference internal" href="#">Artifacts</a><ul>
<li><a class="reference internal" href="#selecting-default-artifacts">Selecting default artifacts</a></li>
<li><a class="reference internal" href="#modifying-default-artifacts">Modifying default artifacts</a></li>
<li><a class="reference internal" href="#defining-custom-artifacts">Defining custom artifacts</a></li>
<li><a class="reference internal" href="#publishing-war-files">Publishing .war files</a></li>
<li><a class="reference internal" href="#using-dependencies-with-artifacts">Using dependencies with artifacts</a></li>
</ul>
</li>
</ul>
</div>
                </div>
              </div></div>
        </div>
      </div>
    </div>
  </div>  
  

  </body>
</html>